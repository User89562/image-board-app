"use strict";(self.webpackChunkvenus_arch=self.webpackChunkvenus_arch||[]).push([[440],{7440:(_i,se,r)=>{r.r(se),r.d(se,{HomeModule:()=>fi});var Ce=r(9633),h=r(6814),y=r(1896),ae=r(9315),le=r(7337),C=(()=>((C=C||{}).waiting="waiting",C.finished="done",C.failed="warning",C.error="error",C.redirect="redirect",C.addAnother="add another",C.cancel="cancel",C))(),v=(()=>((v=v||{})[v.DIRECTION_NONE=0]="DIRECTION_NONE",v[v.DIRECTION_LEFT=2]="DIRECTION_LEFT",v[v.DIRECTION_RIGHT=4]="DIRECTION_RIGHT",v[v.DIRECTION_UP=8]="DIRECTION_UP",v[v.DIRECTION_DOWN=16]="DIRECTION_DOWN",v))(),w=(()=>((w=w||{}).FAV="favourites",w.LIKE="Like",w.OVERALL="Overall",w))();class D{constructor(){}static get messageType(){return C}static get swipeDirection(){return v}static get ratingServices(){return w}}var g=r(6825);class L{constructor(){this.archive=[],this.skipped=[],this.delete=[]}}class xe{constructor(o,t,i){this.hash=o,this.rating_service_key=t,this.rating=i}}var c=r(9347),e=r(5879),m=r(2296),F=r(6385),J=r(5940);function ye(n,o){1&n&&e._UZ(0,"mat-spinner")}let be=(()=>{class n{constructor(t,i){this.dialogRef=t,this.data=i,this.loading=!0}onClick(){this.dialogRef.close()}onLoad(){this.loading=!1}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(c.so),e.Y36(c.WI))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-dialog-mobile-video-player"]],decls:12,vars:5,consts:[["mat-dialog-title","",1,"title"],["id","dark-mode-divider"],["mat-dialog-content",""],[4,"ngIf"],["controls","","muted","",1,"current-video",3,"hidden","volume","loadeddata"],[3,"src","type"],["mat-dialog-actions","",1,"dialog-action"],["mat-raised-button","","color","warn",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"h1",0),e._uU(1,"HTML5 Player"),e.qZA(),e._UZ(2,"mat-divider",1),e.TgZ(3,"div",2),e.YNc(4,ye,1,0,"mat-spinner",3),e.TgZ(5,"video",4),e.NdJ("loadeddata",function(){return i.onLoad()}),e._UZ(6,"source",5),e._uU(7," Your browser does not support the video tag. "),e.qZA()(),e._UZ(8,"mat-divider",1),e.TgZ(9,"div",6)(10,"button",7),e.NdJ("click",function(){return i.onClick()}),e._uU(11,"Ok"),e.qZA()()),2&t&&(e.xp6(4),e.Q6J("ngIf",i.loading),e.xp6(1),e.Q6J("hidden",i.loading)("volume",0),e.xp6(1),e.Q6J("src",i.data.file_url,e.LSH)("type",i.data.mime))},dependencies:[h.O5,m.lW,F.d,c.uh,c.xY,c.H8,J.Ou],styles:[".mat-list-item[_ngcontent-%COMP%]{padding:2px}.title[_ngcontent-%COMP%]{text-shadow:0 0 1px black}.mat-divider[_ngcontent-%COMP%]{padding:3px}.dialog-action[_ngcontent-%COMP%]{margin-top:5px!important;justify-content:flex-end}.mat-dialog-content[_ngcontent-%COMP%]{white-space:pre-wrap!important}.current-video[_ngcontent-%COMP%]{height:auto;width:100%;object-position:center;object-fit:contain}"]}),n})();var b=r(9038),u=r(3814),A=r(7509);function Te(n,o){1&n&&e._UZ(0,"mat-divider")}function Fe(n,o){if(1&n&&(e.TgZ(0,"mat-list")(1,"mat-list-item"),e._uU(2),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.hij(" ",t,"")}}function Oe(n,o){if(1&n&&(e.TgZ(0,"div",7)(1,"div"),e.YNc(2,Fe,3,1,"mat-list",8),e.qZA()()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("ngForOf",t.data.messageArray)}}let Se=(()=>{class n{constructor(t,i){this.dialogRef=t,this.data=i}onClick(){this.dialogRef.close()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(c.so),e.Y36(c.WI))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-dialog-filter-confirmation"]],decls:11,vars:5,consts:[["mat-dialog-title","",1,"title"],[4,"ngIf"],["mat-dialog-content","","class","dialog-content",4,"ngIf"],["mat-dialog-actions","","fxLayout.lt-md","column","fxLayoutAlign.gt-sm","end","fxLayoutGap.lt-md","15px",1,"dialog-action"],["mat-raised-button","","ngClass.lt-md","cancel-button-mobile","ngClass.gt-sm","cancel-button",3,"click"],["mat-raised-button","","ngClass.lt-md","yes-button-mobile","ngClass.gt-sm","yes-button","cdkFocusInitial","",3,"mat-dialog-close"],["mat-raised-button","","ngClass.lt-md","continue-button-mobile","ngClass.gt-sm","continue-button","color","primary","cdkFocusInitial","",3,"mat-dialog-close"],["mat-dialog-content","",1,"dialog-content"],[4,"ngFor","ngForOf"]],template:function(t,i){1&t&&(e.TgZ(0,"h1",0),e._uU(1),e.qZA(),e.YNc(2,Te,1,0,"mat-divider",1),e.YNc(3,Oe,3,1,"div",2),e.TgZ(4,"div",3)(5,"button",4),e.NdJ("click",function(){return i.onClick()}),e._uU(6," Cancel "),e.qZA(),e.TgZ(7,"button",5),e._uU(8," Commit "),e.qZA(),e.TgZ(9,"button",6),e._uU(10," Commit & Continue "),e.qZA()()),2&t&&(e.xp6(1),e.Oqu(i.data.title),e.xp6(1),e.Q6J("ngIf",i.data.messageArray.length>0),e.xp6(1),e.Q6J("ngIf",i.data.messageArray.length>0),e.xp6(4),e.Q6J("mat-dialog-close","commit"),e.xp6(2),e.Q6J("mat-dialog-close","continue"))},dependencies:[h.sg,h.O5,m.lW,b.i$,b.Tg,F.d,c.ZT,c.uh,c.xY,c.H8,u.xw,u.SQ,u.Wh,A.oO],styles:[".mat-dialog-container[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content}.mat-list-item[_ngcontent-%COMP%]{height:max-content!important}.mat-divider[_ngcontent-%COMP%]{padding:7px}.title[_ngcontent-%COMP%]{color:#b085f5}.dialog-action[_ngcontent-%COMP%]{margin-top:35px!important;border-top:1px solid gray}.dialog-content[_ngcontent-%COMP%]{margin-top:15px}.yes-button[_ngcontent-%COMP%], .cancel-button[_ngcontent-%COMP%]{font-size:11px;width:100px}.continue-button[_ngcontent-%COMP%]{color:#fff;font-size:11px}.yes-button[_ngcontent-%COMP%], .yes-button-mobile[_ngcontent-%COMP%]{background-color:#a00037!important}.cancel-button[_ngcontent-%COMP%], .cancel-button-mobile[_ngcontent-%COMP%]{background-color:#4b636e!important}.cancel-button-mobile[_ngcontent-%COMP%], .yes-button-mobile[_ngcontent-%COMP%], .continue-button-mobile[_ngcontent-%COMP%]{width:155px}"]}),n})();var x=r(617);function we(n,o){if(1&n&&(e.TgZ(0,"a",3)(1,"mat-icon"),e._uU(2),e.qZA(),e._uU(3),e.qZA()),2&n){const t=o.$implicit;e.Q6J("mat-dialog-close",t.listItem),e.xp6(2),e.hij(" ",t.icon," "),e.xp6(1),e.hij(" ",t.name," ")}}let Ae=(()=>{class n{constructor(t,i){this.dialogRef=t,this.data=i}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(c.so),e.Y36(c.WI))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-action-list-dialog"]],decls:8,vars:3,consts:[["mat-list-item","",3,"mat-dialog-close",4,"ngFor","ngForOf"],[1,"action-button"],["mat-flat-button","",1,"cancel-button",3,"mat-dialog-close"],["mat-list-item","",3,"mat-dialog-close"]],template:function(t,i){1&t&&(e.TgZ(0,"h1"),e._uU(1),e.qZA(),e._UZ(2,"mat-divider"),e.TgZ(3,"mat-nav-list"),e.YNc(4,we,4,3,"a",0),e.qZA(),e.TgZ(5,"div",1)(6,"button",2),e._uU(7," Cancel "),e.qZA()()),2&t&&(e.xp6(1),e.hij(" ",i.data.title," "),e.xp6(3),e.Q6J("ngForOf",i.data.listData),e.xp6(2),e.Q6J("mat-dialog-close",!0))},dependencies:[h.sg,m.lW,b.Hk,b.Tg,F.d,c.ZT,x.Hw],styles:[".action-button[_ngcontent-%COMP%]{display:flex;justify-content:right;margin-top:5px}.cancel-button[_ngcontent-%COMP%]{background-color:#1c313a}.mat-icon[_ngcontent-%COMP%]{margin-left:10px;margin-right:10px}"]}),n})();var N=r(3680);function Ze(n,o){1&n&&e._UZ(0,"mat-divider",3)}function Ie(n,o){if(1&n&&(e.TgZ(0,"p",9),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",t," ")}}function ke(n,o){if(1&n&&(e.TgZ(0,"div",6)(1,"div",7),e.YNc(2,Ie,2,1,"p",8),e.qZA()()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("ngForOf",t.data.messageArray)}}let q=(()=>{class n{constructor(t,i){this.dialogRef=t,this.data=i,i.color&&(this.color=i.color)}onClick(){this.dialogRef.close()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(c.so),e.Y36(c.WI))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-dialog-message-box"]],decls:8,vars:5,consts:[["mat-dialog-title","",1,"title"],["id","dark-mode-divider",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["id","dark-mode-divider"],["mat-dialog-actions","",1,"dialog-action"],["mat-raised-button","","color","warn",3,"click"],["mat-dialog-content",""],["fxLayoutAlign","start center"],["matLine","","fxLayoutAlign","center center",4,"ngFor","ngForOf"],["matLine","","fxLayoutAlign","center center"]],template:function(t,i){1&t&&(e.TgZ(0,"h1",0),e._uU(1),e.qZA(),e.YNc(2,Ze,1,0,"mat-divider",1),e.YNc(3,ke,3,1,"div",2),e._UZ(4,"mat-divider",3),e.TgZ(5,"div",4)(6,"button",5),e.NdJ("click",function(){return i.onClick()}),e._uU(7,"Ok"),e.qZA()()),2&t&&(e.Udp("color",i.color),e.xp6(1),e.Oqu(i.data.title),e.xp6(1),e.Q6J("ngIf",i.data.messageArray.length>0),e.xp6(1),e.Q6J("ngIf",i.data.messageArray.length>0))},dependencies:[h.sg,h.O5,m.lW,F.d,c.uh,c.xY,c.H8,N.X2,u.Wh],styles:[".mat-list-item[_ngcontent-%COMP%]{padding:2px}.title[_ngcontent-%COMP%]{text-shadow:0 0 1px black}.mat-divider[_ngcontent-%COMP%]{padding:3px}.dialog-action[_ngcontent-%COMP%]{margin-top:5px!important;justify-content:flex-end}.mat-dialog-content[_ngcontent-%COMP%]{white-space:pre-wrap!important}"]}),n})();function Me(n,o){1&n&&e._UZ(0,"mat-divider")}function Pe(n,o){if(1&n&&(e.TgZ(0,"mat-list")(1,"mat-list-item"),e._uU(2),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.hij(" ",t,"")}}function De(n,o){if(1&n&&(e.TgZ(0,"div",6)(1,"div"),e.YNc(2,Pe,3,1,"mat-list",7),e.qZA()()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("ngForOf",t.data.messageArray)}}let Ne=(()=>{class n{constructor(t,i){this.dialogRef=t,this.data=i}onClick(){this.dialogRef.close()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(c.so),e.Y36(c.WI))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-dialog-confirmation-box"]],decls:9,vars:4,consts:[["mat-dialog-title","",1,"title"],[4,"ngIf"],["mat-dialog-content","","class","dialog-content",4,"ngIf"],["mat-dialog-actions","",1,"dialog-action"],["mat-raised-button","",1,"cancel-button",3,"click"],["mat-raised-button","","cdkFocusInitial","",1,"yes-button",3,"mat-dialog-close"],["mat-dialog-content","",1,"dialog-content"],[4,"ngFor","ngForOf"]],template:function(t,i){1&t&&(e.TgZ(0,"h1",0),e._uU(1),e.qZA(),e.YNc(2,Me,1,0,"mat-divider",1),e.YNc(3,De,3,1,"div",2),e.TgZ(4,"div",3)(5,"button",4),e.NdJ("click",function(){return i.onClick()}),e._uU(6,"Cancel"),e.qZA(),e.TgZ(7,"button",5),e._uU(8,"Yes"),e.qZA()()),2&t&&(e.xp6(1),e.Oqu(i.data.title),e.xp6(1),e.Q6J("ngIf",i.data.messageArray.length>0),e.xp6(1),e.Q6J("ngIf",i.data.messageArray.length>0),e.xp6(4),e.Q6J("mat-dialog-close",!0))},dependencies:[h.sg,h.O5,m.lW,b.i$,b.Tg,F.d,c.ZT,c.uh,c.xY,c.H8],styles:[".mat-dialog-container[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content}.mat-list-item[_ngcontent-%COMP%]{height:max-content!important}.mat-divider[_ngcontent-%COMP%]{padding:7px}.title[_ngcontent-%COMP%]{color:#b085f5}.dialog-action[_ngcontent-%COMP%]{margin-top:35px!important;justify-content:flex-end;border-top:1px solid gray}.dialog-content[_ngcontent-%COMP%]{margin-top:15px}.yes-button[_ngcontent-%COMP%], .cancel-button[_ngcontent-%COMP%]{font-size:11px;width:100px}.yes-button[_ngcontent-%COMP%]{background-color:#a00037!important}.cancel-button[_ngcontent-%COMP%]{background-color:#4b636e!important}"]}),n})();class j{constructor(o){this.dialog=o}displayError(o,t){let i=[];i="string"==typeof o?[o]:o,this.dialog.open(q,{data:{messageArray:i,title:t,color:"#E57373"}})}displayMessage(o,t,i){let s=[];return s="string"==typeof o?[o]:o,this.dialog.open(q,i?{data:{messageArray:s,title:t,color:i},restoreFocus:!1}:{data:{messageArray:s,title:t},restoreFocus:!1})}displayConfirmation(o,t){let i=[];return i="string"==typeof o?[o]:o,this.dialog.open(Ne,{data:{messageArray:i,title:t}})}displayFilterConfirmation(o,t){let i=[];return i="string"==typeof o?[o]:o,this.dialog.open(Se,{data:{messageArray:i,title:t}})}displayList(o){return this.dialog.open(Ae,{data:o,autoFocus:!1})}displayVideoPlayer(o){return this.dialog.open(be,{data:o,autoFocus:!1})}mapToArray(o){const t=[];for(const i of o.entries())t.push("regex"===i[0]?i[0]+" : "+JSON.stringify(i[1]):i[0]+" : "+i[1]);return t}}const G=[(0,g.oB)({transform:"translate3d(0, 0, 0)",offset:0}),(0,g.oB)({transform:"translate3d(-150%, 0, 0)",opacity:0,offset:1})],W=[(0,g.oB)({transform:"translate3d(0, 0, 0)",offset:0}),(0,g.oB)({transform:"translate3d(150%, 0, 0)",opacity:0,offset:1})];var B=r(8645);let O=(()=>{class n{constructor(){this.processingSource=new e.vpe,this.overlaySource=new B.x,this.fullscreenOverlaySource=new B.x,this.sendFilesSource=new B.x,this.proccessingFound$=this.processingSource.asObservable(),this.overlaySourceFound$=this.overlaySource.asObservable(),this.fullscreenOverlaySourceFound$=this.fullscreenOverlaySource.asObservable(),this.sendFilesSourceFound$=this.sendFilesSource.asObservable()}announceProcessing(t){this.processingSource.emit(t)}announceFullscreenOverlay(t){this.fullscreenOverlaySource.next(t)}closeFullscreenOverlay(t){this.sendFilesSource.next(t)}closeOverlay(t){this.overlaySource.next(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Ue(n,o){1&n&&e._UZ(0,"mat-spinner")}function Le(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div"),e.YNc(1,Ue,1,0,"mat-spinner",6),e.TgZ(2,"img",7),e.NdJ("load",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.onLoad())}),e.qZA()()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.loading),e.xp6(1),e.Q6J("hidden",t.loading&&!t.complete)("src",t.currentFile.file_url,e.LSH)}}const Je=function(n){return{background:n,"background-size":"contain"}};function Re(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",8)(1,"img",9),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.openVideoPlayer(s.currentFile))}),e.qZA()()}if(2&n){const t=e.oxw(2);e.Q6J("ngStyle",e.VKq(1,Je,"url("+t.currentFile.thumbnail_url+") no-repeat center center"))}}function Ye(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",3),e.NdJ("swipe",function(s){e.CHM(t);const a=e.oxw();return e.KtG(a.onSwipe(s))})("@cardAnimator.done",function(s){e.CHM(t);const a=e.oxw();return e.KtG(a.resetAnimationState(s))})("swipeleft",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.startAnimation("slideOutLeft"))})("swiperight",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.startAnimation("slideOutRight"))}),e.YNc(1,Le,3,3,"div",4),e.YNc(2,Re,2,3,"ng-template",null,5,e.W1O),e.qZA()}if(2&n){const t=e.MAs(3),i=e.oxw();e.Q6J("@cardAnimator",i.animationState),e.xp6(1),e.Q6J("ngIf",i.imageType(i.currentFile.mime))("ngIfElse",t)}}let Ee=(()=>{class n{constructor(t,i){this.injectorService=t,this.loading=!0,this.enumUtil=D,this.complete=!1,this.animationState="",this.fileChanges=new L,this.dialogUtils=new j(i),this.subscriptions=[],this.hydrusFiles=[],this.currentFileIndex=0}ngOnDestroy(){this.subscriptions.forEach(t=>{t.unsubscribe()})}ngOnInit(){this.loading=!0,this.subscriptions.push(this.injectorService.fullscreenOverlaySourceFound$.subscribe(t=>{this.hydrusFiles=t.files,this.currentFileIndex=t.currentIndex,this.currentFile=this.hydrusFiles[this.currentFileIndex]}))}onSwipe(t){t.direction===this.enumUtil.swipeDirection.DIRECTION_LEFT?this.sendToArchive():t.direction===this.enumUtil.swipeDirection.DIRECTION_RIGHT?this.sendToDelete():t.direction===this.enumUtil.swipeDirection.DIRECTION_UP?this.sendToPrevious():t.direction===this.enumUtil.swipeDirection.DIRECTION_DOWN&&this.sendToSkip()}onLoad(){this.loading=!1}sendToDelete(){this.fileChanges.delete.push(this.currentFile),this.currentFileIndex+1<this.hydrusFiles.length?setTimeout(()=>this.nextImage(),500):this.sendSelectedFiles()}sendToArchive(){this.fileChanges.archive.push(this.currentFile),this.currentFileIndex+1<this.hydrusFiles.length?setTimeout(()=>this.nextImage(),500):this.sendSelectedFiles()}sendToSkip(){this.fileChanges.skipped.push(this.currentFile),this.currentFileIndex+1<this.hydrusFiles.length?setTimeout(()=>this.nextImage(),500):this.sendSelectedFiles()}sendToPrevious(){this.currentFileIndex-1>=0&&(this.currentFileIndex--,this.currentFile=this.hydrusFiles[this.currentFileIndex]),this.fileChanges.archive.includes(this.currentFile)?this.fileChanges.archive.splice(this.fileChanges.archive.indexOf(this.currentFile),1):this.fileChanges.delete.includes(this.currentFile)?this.fileChanges.delete.splice(this.fileChanges.delete.indexOf(this.currentFile),1):this.fileChanges.skipped.includes(this.currentFile)&&this.fileChanges.skipped.splice(this.fileChanges.skipped.indexOf(this.currentFile),1)}nextImage(){this.loading=!0,this.currentFile=this.hydrusFiles[this.currentFileIndex+1],this.currentFileIndex++}closeFullscreen(){this.fileChanges.archive.length>0||this.fileChanges.delete.length>0?this.dialogUtils.displayConfirmation("Would you like to commit current changes?","Filtering Cancelled").afterClosed().subscribe(i=>{this.injectorService.closeFullscreenOverlay(i?{files:this.fileChanges,makeChanges:!0,continueFilter:!1}:{files:this.fileChanges,makeChanges:!1,continueFilter:!1})}):this.injectorService.closeFullscreenOverlay({files:this.fileChanges,makeChanges:!1,continueFilter:!1})}sendSelectedFiles(){this.loading=!0,this.dialogUtils.displayFilterConfirmation("Would you like to commit current changes?","Filtering Complete").afterClosed().subscribe(i=>{this.injectorService.closeFullscreenOverlay("continue"===i?{files:this.fileChanges,makeChanges:!0,continueFilter:!0}:"commit"===i?{files:this.fileChanges,makeChanges:!0,continueFilter:!1}:{files:this.fileChanges,makeChanges:!1,continueFilter:!1})})}startAnimation(t){this.animationState||(this.animationState=t)}resetAnimationState(t){this.animationState=""}imageType(t){return!t.includes("video")}openVideoPlayer(t){this.dialogUtils.displayVideoPlayer(t)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(O),e.Y36(c.uw))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-overlay-archive-delete-filter-mobile"]],decls:7,vars:3,consts:[["mat-icon-button","",1,"close-fullscreen-button",3,"click"],["fxLayoutAlign","center center","class","custom-swiper-container",3,"swipe","swipeleft","swiperight",4,"ngIf"],[1,"num-files-container"],["fxLayoutAlign","center center",1,"custom-swiper-container",3,"swipe","swipeleft","swiperight"],[4,"ngIf","ngIfElse"],["video",""],[4,"ngIf"],["draggable","false",1,"current-image",3,"hidden","src","load"],["fxLayoutAlign","center center",1,"current-image",3,"ngStyle"],["src","assets/images/video-play-button.png","draggable","false",1,"video-play-button",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div")(1,"button",0),e.NdJ("click",function(){return i.closeFullscreen()}),e.TgZ(2,"mat-icon"),e._uU(3,"close"),e.qZA()(),e.YNc(4,Ye,4,3,"div",1),e.TgZ(5,"div",2),e._uU(6),e.qZA()()),2&t&&(e.xp6(4),e.Q6J("ngIf",i.hydrusFiles&&i.currentFile),e.xp6(2),e.AsE(" ",i.currentFileIndex+1," / ",i.hydrusFiles.length," "))},dependencies:[h.O5,h.PC,m.RK,J.Ou,x.Hw,u.Wh,A.Zl],styles:[".custom-swiper-container[_ngcontent-%COMP%]{height:96vh;width:96vw}.current-image[_ngcontent-%COMP%]{height:95vh;width:95vw;object-position:center;object-fit:contain}.current-video[_ngcontent-%COMP%]{height:auto;width:90vw;object-position:center;object-fit:contain}.close-fullscreen-button[_ngcontent-%COMP%]{color:#ff4500;position:absolute;right:30px;top:10;font-size:35px;height:35px;width:35px;line-height:35px}.close-fullscreen-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:35px;height:35px;width:35px;line-height:35px}.num-files-container[_ngcontent-%COMP%]{position:absolute;right:15px;bottom:15px}.video-play-button[_ngcontent-%COMP%]{opacity:.75;height:auto;width:90vw}"],data:{animation:[(0,g.X$)("cardAnimator",[(0,g.eR)("* => slideOutLeft",(0,g.jt)(655,(0,g.F4)(G))),(0,g.eR)("* => slideOutRight",(0,g.jt)(655,(0,g.F4)(W)))])]}}),n})();var V=r(8005),f=(()=>((f=f||{})[f.Image=0]="Image",f[f.Video=1]="Video",f[f.Audio=2]="Audio",f[f.Flash=3]="Flash",f[f.Unsupported=4]="Unsupported",f))();class Z{static getNamespace(o){return o?.includes(":")?(o.startsWith("-")&&(o=o.substring(1)),o.split(":")[0].toLowerCase()):""}static getNamespaceNoSpace(o){return o?.includes(":")?(o.startsWith("-")&&(o=o.substring(1)),o.split(":")[0].replace(/\s+/g,"-").toLowerCase()):""}static tagsObjectFromFile(o){return o.tags}static AllTagsFromFile(o){return this.allKnownTags(this.tagsObjectFromFile(o))}static allKnownTags(o){return"all known tags"===o["616c6c206b6e6f776e2074616773"].name?o["616c6c206b6e6f776e2074616773"].display_tags[0]:[]}static namespaceTagFromFile(o,t){return Z.AllTagsFromFile(o).find(i=>Z.getNamespace(i)===t)}static getTagValue(o){return o&&(o.startsWith("-")&&(o=o.substring(1)),o.includes(":"))?o.split(":")[1].toLowerCase():o}}var He=r(2939),R=r(3305),k=r(2557);function Qe(n,o){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.AsE("",t.data.file.width,"x",t.data.file.height,"")}}function qe(n,o){if(1&n&&(e.TgZ(0,"mat-list-item")(1,"a",9),e._uU(2),e.qZA()()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("href",t,e.LSH),e.xp6(1),e.Oqu(t)}}function je(n,o){if(1&n&&(e.TgZ(0,"mat-expansion-panel")(1,"mat-expansion-panel-header"),e._uU(2),e.qZA(),e.TgZ(3,"mat-nav-list"),e.YNc(4,qe,3,2,"mat-list-item",8),e.qZA()()),2&n){const t=e.oxw();e.xp6(2),e.hij(" Known URLs (",t.data.file.known_urls.length,") "),e.xp6(2),e.Q6J("ngForOf",t.data.file.known_urls)}}function Ge(n,o){if(1&n&&(e.TgZ(0,"mat-chip",15),e._uU(1),e.qZA()),2&n){const t=o.$implicit,i=e.oxw(4);e.Q6J("ngClass","tag-namespace-"+i.tagUtils.getNamespaceNoSpace(t)),e.xp6(1),e.hij(" ",t," ")}}function We(n,o){if(1&n&&(e.TgZ(0,"mat-chip-listbox",13),e.YNc(1,Ge,2,2,"mat-chip",14),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.statuses.display_tags[0])}}function Be(n,o){if(1&n&&(e.TgZ(0,"mat-expansion-panel")(1,"mat-expansion-panel-header"),e._uU(2),e.qZA(),e.YNc(3,We,2,1,"ng-template",12),e.qZA()),2&n){const t=o.$implicit;e.xp6(2),e.AsE(" ",t.serviceName," (",t.statuses.display_tags[0].length,") ")}}function Ve(n,o){if(1&n&&(e.TgZ(0,"div")(1,"h3",10),e._uU(2,"Tags"),e.qZA(),e.TgZ(3,"mat-accordion",11),e.YNc(4,Be,4,2,"mat-expansion-panel",8),e.qZA()()),2&n){const t=e.oxw();e.xp6(4),e.Q6J("ngForOf",t.tags)}}let re=(()=>{class n{constructor(t,i){this.data=t,this.snackbar=i,this.tagUtils=Z,this.Object=Object,this.tags=Object.entries(Z.tagsObjectFromFile(this.data.file)).filter(([s,a])=>a.display_tags[0]&&a.display_tags[0].length>0).map(([s,a])=>({serviceName:s,statuses:a}))}get fileIcon(){switch(this.data.file.file_type){case f.Image:return"photo";case f.Video:return"movie";default:return"insert_drive_file"}}formatBytes(t,i=2){if(!+t)return"0 Bytes";const a=i<0?0:i,d=Math.floor(Math.log(t)/Math.log(1024));return`${parseFloat((t/Math.pow(1024,d)).toFixed(a))} ${["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][d]}`}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(V.OG),e.Y36(He.ux))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-file-info-sheet"]],decls:25,vars:10,consts:[["mat-dialog-title",""],["role","list"],["role","listitem"],["mat-list-icon",""],["mat-line",""],["mat-line","",1,"metadata-line"],[4,"ngIf"],["mat-icon-button","","rel","noopener noreferrer","target","_blank","title","Open file in new tab",3,"href"],[4,"ngFor","ngForOf"],["matLine","","target","_blank","rel","noopener noreferrer",3,"href"],[1,"mat-subheading-2"],["multi",""],["matExpansionPanelContent",""],["aria-orientation","vertical","aria-label","File tags",1,"mat-chip-list-stacked"],["class","tag-chip",3,"ngClass",4,"ngFor","ngForOf"],[1,"tag-chip",3,"ngClass"]],template:function(t,i){1&t&&(e.TgZ(0,"h2",0),e._uU(1,"File Info"),e.qZA(),e.TgZ(2,"mat-list",1)(3,"mat-list-item",2)(4,"mat-icon",3),e._uU(5),e.qZA(),e.TgZ(6,"div",4),e._uU(7),e.qZA(),e.TgZ(8,"div",5)(9,"span"),e._uU(10),e.qZA(),e.YNc(11,Qe,2,2,"span",6),e.TgZ(12,"span"),e._uU(13),e.qZA()()(),e.TgZ(14,"mat-list-item",2)(15,"mat-icon",3),e._uU(16),e.qZA(),e.TgZ(17,"div",4),e._uU(18),e.qZA(),e.TgZ(19,"a",7)(20,"mat-icon"),e._uU(21,"open_in_new"),e.qZA()()()(),e.YNc(22,je,5,2,"mat-expansion-panel",6),e._UZ(23,"br"),e.YNc(24,Ve,5,1,"div",6)),2&t&&(e.xp6(5),e.Oqu(i.fileIcon),e.xp6(2),e.Oqu(i.data.file.file_id),e.xp6(3),e.Oqu(i.data.file.mime),e.xp6(1),e.Q6J("ngIf",i.data.file.width&&i.data.file.height),e.xp6(2),e.Oqu(i.formatBytes(i.data.file.size)),e.xp6(3),e.Oqu(i.data.file.is_inbox?"inbox":i.data.file.is_trashed?"delete":"archive"),e.xp6(2),e.hij(" ",i.data.file.is_inbox?"In Inbox":i.data.file.is_trashed?"In Trash":"Archived"," "),e.xp6(1),e.s9C("href",i.data.file.file_url,e.LSH),e.xp6(3),e.Q6J("ngIf",i.data.file.known_urls),e.xp6(2),e.Q6J("ngIf",i.tags&&i.tags.length>1))},dependencies:[h.mk,h.sg,h.O5,m.o6,R.pp,R.ib,R.yz,R.HS,b.i$,b.Hk,b.Tg,c.uh,x.Hw,N.X2,k.HS,k.z2,A.oO],styles:[".metadata-line[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:not(:last-of-type){margin-right:20px}.mat-dialog-title[_ngcontent-%COMP%]{margin-bottom:0}.mat-list[_ngcontent-%COMP%]{padding-top:0}"]}),n})();var ze=r(4664),Ke=r(2096),z=r(7398),$e=r(9397),Y=r(6552);let M=(()=>{class n{constructor(t){this.apiService=t,this.allTags=new Set}getFileWithMetadataFromSearch(t,i,s){return this.apiService.getFilesSearch(t,i,s).pipe((0,ze.w)(a=>this.getThumbnailAndMetadata(a.file_ids)))}getThumbnailAndMetadata(t){return 0===t.length?(0,Ke.of)([]):this.apiService.getFileMetadata(t).pipe((0,z.U)(i=>i.metadata.map(s=>({...s,thumbnail_url:this.apiService.getThumbnailURLFromHash(s.hash),file_url:this.apiService.getFileURLFromHash(s.hash)}))),(0,$e.b)(i=>this.AddTags(i)))}downloadFile(t){return this.apiService.getFileAsBlob(t.hash).pipe((0,z.U)(i=>new File([i],t.hash+t.ext)))}AddTags(t){console.log(t),t.forEach(i=>{Z.AllTagsFromFile(i).forEach(s=>this.allTags.add(s))})}getKnownTags(){return this.allTags}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(Y.s))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var E=r(2596);const Xe=["videoPlayer"];function et(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",4),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.playVideo())}),e.TgZ(1,"mat-icon"),e._uU(2,"play_arrow"),e.qZA()()}}function tt(n,o){1&n&&e._UZ(0,"mat-spinner")}function it(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"img",17),e.NdJ("load",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.onLoad())}),e.qZA()()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("hidden",t.loading&&!t.complete)("src",t.currentFile.file_url,e.LSH)}}function nt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"video",18,19),e.NdJ("loadeddata",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.onLoad())}),e._UZ(2,"source",20),e._uU(3," Your browser does not support the video tag. "),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("muted",!0)("hidden",t.loading&&!t.complete),e.xp6(2),e.Q6J("src",t.currentFile.file_url,e.LSH)("type",t.currentFile.mime)}}function ot(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",13),e.NdJ("swipe",function(s){e.CHM(t);const a=e.oxw();return e.KtG(a.onSwipe(s))})("@cardAnimator.done",function(s){e.CHM(t);const a=e.oxw();return e.KtG(a.resetAnimationState(s))})("swipeleft",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.startAnimation("slideOutLeft"))})("swiperight",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.startAnimation("slideOutRight"))}),e.YNc(1,tt,1,0,"mat-spinner",14),e.YNc(2,it,2,2,"div",15),e.YNc(3,nt,4,4,"ng-template",null,16,e.W1O),e.qZA()}if(2&n){const t=e.MAs(4),i=e.oxw();e.Q6J("@cardAnimator",i.animationState),e.xp6(1),e.Q6J("ngIf",i.loading),e.xp6(1),e.Q6J("ngIf",i.imageType(i.currentFile.mime))("ngIfElse",t)}}let st=(()=>{class n{constructor(t,i,s,a){this.injectorService=t,this.fileService=s,this.bottomSheet=a,this.loading=!0,this.enumUtil=D,this.complete=!1,this.dialogOnClose=!0,this.animationState="",this.fileChanges=new L,this.dialogUtils=new j(i),this.subscriptions=[],this.hydrusFiles=[],this.currentFileIndex=0}ngOnDestroy(){this.subscriptions.forEach(t=>{t.unsubscribe()})}ngOnInit(){this.loading=!0,this.subscriptions.push(this.injectorService.fullscreenOverlaySourceFound$.subscribe(t=>{this.hydrusFiles=t.files,this.currentFileIndex=t.currentIndex,this.currentFile=this.hydrusFiles[this.currentFileIndex],t.currentFileChanges&&(this.fileChanges=t.currentFileChanges),!1===t.dialogOnClose&&(this.dialogOnClose=!1)}))}onSwipe(t){t.direction===this.enumUtil.swipeDirection.DIRECTION_LEFT?this.sendToArchive():t.direction===this.enumUtil.swipeDirection.DIRECTION_RIGHT&&this.sendToDelete()}onLoad(){this.loading=!1}sendToDelete(){this.fileChanges.delete.push(this.currentFile),this.currentFileIndex+1<this.hydrusFiles.length?setTimeout(()=>this.nextImage(),500):this.sendSelectedFiles()}sendToArchive(){this.fileChanges.archive.push(this.currentFile),this.currentFileIndex+1<this.hydrusFiles.length?setTimeout(()=>this.nextImage(),500):this.sendSelectedFiles()}sendToSkip(){this.fileChanges.skipped.push(this.currentFile),this.currentFileIndex+1<this.hydrusFiles.length?setTimeout(()=>this.nextImage(),500):this.sendSelectedFiles()}sendToPrevious(){this.currentFileIndex-1>=0&&(this.currentFileIndex--,this.currentFile=this.hydrusFiles[this.currentFileIndex]),this.fileChanges.archive.includes(this.currentFile)?this.fileChanges.archive.splice(this.fileChanges.archive.indexOf(this.currentFile),1):this.fileChanges.delete.includes(this.currentFile)?this.fileChanges.delete.splice(this.fileChanges.delete.indexOf(this.currentFile),1):this.fileChanges.skipped.includes(this.currentFile)&&this.fileChanges.skipped.splice(this.fileChanges.skipped.indexOf(this.currentFile),1)}nextImage(){this.loading=!0,this.currentFile=this.hydrusFiles[this.currentFileIndex+1],this.currentFileIndex++}closeFullscreen(){(this.fileChanges.archive.length>0||this.fileChanges.delete.length>0)&&this.dialogOnClose?this.dialogUtils.displayConfirmation("Would you like to commit current changes?","Filtering Cancelled").afterClosed().subscribe(i=>{this.injectorService.closeFullscreenOverlay(i?{files:this.fileChanges,makeChanges:!0,continueFilter:!1}:{files:this.fileChanges,makeChanges:!1,continueFilter:!1})}):this.injectorService.closeFullscreenOverlay({files:this.fileChanges,makeChanges:!1,continueFilter:!1})}sendSelectedFiles(){this.loading=!0,this.dialogUtils.displayFilterConfirmation("Would you like to commit current changes?","Filtering Complete").afterClosed().subscribe(i=>{this.injectorService.closeFullscreenOverlay(this.dialogOnClose?"continue"===i?{files:this.fileChanges,makeChanges:!0,continueFilter:!0}:"commit"===i?{files:this.fileChanges,makeChanges:!0,continueFilter:!1}:{files:this.fileChanges,makeChanges:!1,continueFilter:!1}:{files:this.fileChanges,makeChanges:!0,continueFilter:!1})})}startAnimation(t){this.animationState||(this.animationState=t)}resetAnimationState(t){this.animationState=""}imageType(t){return!t?.includes("video")}playVideo(){this.videoPlayer.nativeElement.play()}downloadFile(t){this.fileService.downloadFile(t).subscribe({next:i=>{const s=document.createElement("a");document.body.appendChild(s);let a=window.URL.createObjectURL(i);s.href=a,s.download=`${t.hash}.${t.ext}`,s.click(),window.URL.revokeObjectURL(a),s.remove(),window.open(a)}})}openBottomSheet(t){this.bottomSheet.open(re,{data:{file:t},panelClass:"file-info-panel",closeOnNavigation:!0})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(O),e.Y36(c.uw),e.Y36(M),e.Y36(V.ch))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-overlay-archive-delete-filter"]],viewQuery:function(t,i){if(1&t&&e.Gf(Xe,5),2&t){let s;e.iGM(s=e.CRH())&&(i.videoPlayer=s.first)}},decls:28,vars:4,consts:[[1,"main-container"],["fxLayout","center center",1,"top-buttons-container"],["mat-icon-button","",1,"close-fullscreen-button",3,"click"],["mat-icon-button","","class","play-video-button",3,"click",4,"ngIf"],["mat-icon-button","",1,"play-video-button",3,"click"],["fxLayoutAlign","center center","class","custom-swiper-container",3,"swipe","swipeleft","swiperight",4,"ngIf"],["mat-icon-button","",1,"delete-button",3,"click"],["mat-icon-button","",1,"archive-button",3,"click"],["fxLayout","row","fxLayoutAlign","space-evenly center"],["mat-icon-button","","matTooltip","go to previous file",1,"previous-button",3,"click"],["mat-icon-button","","matTooltip","download file",1,"download-button",3,"click"],["mat-icon-button","","matTooltip","skip current file",1,"skip-button",3,"click"],[1,"num-files-container"],["fxLayoutAlign","center center",1,"custom-swiper-container",3,"swipe","swipeleft","swiperight"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["video",""],["draggable","false",1,"current-image",3,"hidden","src","load"],["controls","",1,"current-video",3,"muted","hidden","loadeddata"],["videoPlayer",""],[3,"src","type"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"button",2),e.NdJ("click",function(){return i.closeFullscreen()}),e.TgZ(3,"mat-icon"),e._uU(4,"close"),e.qZA()(),e.YNc(5,et,3,0,"button",3),e.TgZ(6,"button",4),e.NdJ("click",function(){return i.openBottomSheet(i.currentFile)}),e.TgZ(7,"mat-icon"),e._uU(8,"info"),e.qZA()()(),e.YNc(9,ot,5,4,"div",5),e.TgZ(10,"button",6),e.NdJ("click",function(){return i.sendToDelete()}),e.TgZ(11,"mat-icon"),e._uU(12,"delete"),e.qZA()(),e.TgZ(13,"button",7),e.NdJ("click",function(){return i.sendToArchive()}),e.TgZ(14,"mat-icon"),e._uU(15,"archive"),e.qZA()(),e.TgZ(16,"div",8)(17,"button",9),e.NdJ("click",function(){return i.sendToPrevious()}),e.TgZ(18,"mat-icon"),e._uU(19,"arrow_back"),e.qZA()(),e.TgZ(20,"button",10),e.NdJ("click",function(){return i.downloadFile(i.currentFile)}),e.TgZ(21,"mat-icon"),e._uU(22,"download"),e.qZA()(),e.TgZ(23,"button",11),e.NdJ("click",function(){return i.sendToSkip()}),e.TgZ(24,"mat-icon"),e._uU(25,"skip_next"),e.qZA()()(),e.TgZ(26,"div",12),e._uU(27),e.qZA()()),2&t&&(e.xp6(5),e.Q6J("ngIf",!i.imageType(null==i.currentFile?null:i.currentFile.mime)),e.xp6(4),e.Q6J("ngIf",i.currentFile),e.xp6(18),e.AsE(" ",i.currentFileIndex+1," / ",i.hydrusFiles.length," "))},dependencies:[h.O5,m.RK,J.Ou,x.Hw,E.gM,u.xw,u.Wh],styles:[".custom-swiper-container[_ngcontent-%COMP%]{height:87vh;width:90vw;padding:5px}.current-image[_ngcontent-%COMP%]{height:85vh;max-width:80vw;object-position:center;object-fit:contain}.current-video[_ngcontent-%COMP%]{width:87vw;height:85vh;object-position:center;object-fit:contain}.archive-button[_ngcontent-%COMP%]{position:absolute;height:87vh;width:55px;top:9%;right:25px}.delete-button[_ngcontent-%COMP%]{position:absolute;height:87vh;width:55px;left:25px;top:9%}.archive-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%], .delete-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%], .skip-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%], .previous-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%], .download-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:55px;height:55px;width:55px;line-height:55px;color:#00b0ff;text-shadow:0px 0px 1px black}.close-fullscreen-button[_ngcontent-%COMP%]{color:#ff4500;position:absolute;right:30px;font-size:35px;height:35px;width:35px;line-height:35px}.close-fullscreen-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:35px;height:35px;width:35px;line-height:35px}.play-video-button[_ngcontent-%COMP%]{color:#bb002f;font-size:45px;height:45px;width:45px;line-height:45px;margin-left:auto;margin-right:auto}.play-video-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:45px;height:45px;width:45px;line-height:45px}.num-files-container[_ngcontent-%COMP%]{position:absolute;right:15px;bottom:15px}.top-buttons-container[_ngcontent-%COMP%]{height:60px}"],data:{animation:[(0,g.X$)("cardAnimator",[(0,g.eR)("* => slideOutLeft",(0,g.jt)(855,(0,g.F4)(G))),(0,g.eR)("* => slideOutRight",(0,g.jt)(855,(0,g.F4)(W)))])]}}),n})();const at=["videoPlayer"];function lt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",4),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.playVideo())}),e.TgZ(1,"mat-icon"),e._uU(2,"play_arrow"),e.qZA()()}}function rt(n,o){1&n&&e._UZ(0,"mat-spinner")}function ct(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"img",17),e.NdJ("load",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.onLoad())}),e.qZA()()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("hidden",t.loading&&!t.complete)("src",t.currentFile.file_url,e.LSH)}}function ht(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"video",18,19),e.NdJ("loadeddata",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.onLoad())}),e._UZ(2,"source",20),e._uU(3," Your browser does not support the video tag. "),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("muted",!0)("hidden",t.loading&&!t.complete),e.xp6(2),e.Q6J("src",t.currentFile.file_url,e.LSH)("type",t.currentFile.mime)}}function ut(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",13),e.NdJ("swipe",function(s){e.CHM(t);const a=e.oxw();return e.KtG(a.onSwipe(s))})("@cardAnimator.done",function(s){e.CHM(t);const a=e.oxw();return e.KtG(a.resetAnimationState(s))})("swipeleft",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.startAnimation("slideOutLeft"))})("swiperight",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.startAnimation("slideOutRight"))}),e.YNc(1,rt,1,0,"mat-spinner",14),e.YNc(2,ct,2,2,"div",15),e.YNc(3,ht,4,4,"ng-template",null,16,e.W1O),e.qZA()}if(2&n){const t=e.MAs(4),i=e.oxw();e.Q6J("@cardAnimator",i.animationState),e.xp6(1),e.Q6J("ngIf",i.loading),e.xp6(1),e.Q6J("ngIf",i.imageType(i.currentFile.mime))("ngIfElse",t)}}let gt=(()=>{class n{constructor(t,i,s,a){this.injectorService=t,this.fileService=s,this.bottomSheet=a,this.loading=!0,this.enumUtil=D,this.complete=!1,this.dialogOnClose=!0,this.animationState="",this.fileChanges=new L,this.dialogUtils=new j(i),this.subscriptions=[],this.hydrusFiles=[],this.currentFileIndex=0}ngOnDestroy(){this.subscriptions.forEach(t=>{t.unsubscribe()})}ngOnInit(){this.loading=!0,this.subscriptions.push(this.injectorService.fullscreenOverlaySourceFound$.subscribe(t=>{this.hydrusFiles=t.files,this.currentFileIndex=t.currentIndex,this.currentFile=this.hydrusFiles[this.currentFileIndex],t.currentFileChanges&&(this.fileChanges=t.currentFileChanges),!1===t.dialogOnClose&&(this.dialogOnClose=!1)}))}onSwipe(t){t.direction===this.enumUtil.swipeDirection.DIRECTION_LEFT?this.sendToArchive():t.direction===this.enumUtil.swipeDirection.DIRECTION_RIGHT&&this.sendToDelete()}onLoad(){this.loading=!1}sendToDelete(){this.fileChanges.delete.push(this.currentFile),this.currentFileIndex+1<this.hydrusFiles.length?setTimeout(()=>this.nextImage(),500):this.sendSelectedFiles()}sendToArchive(){this.fileChanges.archive.push(this.currentFile),this.currentFileIndex+1<this.hydrusFiles.length?setTimeout(()=>this.nextImage(),500):this.sendSelectedFiles()}sendToSkip(){this.fileChanges.skipped.push(this.currentFile),this.currentFileIndex+1<this.hydrusFiles.length?setTimeout(()=>this.nextImage(),500):this.sendSelectedFiles()}sendToPrevious(){this.currentFileIndex-1>=0&&(this.currentFileIndex--,this.currentFile=this.hydrusFiles[this.currentFileIndex]),this.fileChanges.archive.includes(this.currentFile)?this.fileChanges.archive.splice(this.fileChanges.archive.indexOf(this.currentFile),1):this.fileChanges.delete.includes(this.currentFile)?this.fileChanges.delete.splice(this.fileChanges.delete.indexOf(this.currentFile),1):this.fileChanges.skipped.includes(this.currentFile)&&this.fileChanges.skipped.splice(this.fileChanges.skipped.indexOf(this.currentFile),1)}nextImage(){this.loading=!0,this.currentFile=this.hydrusFiles[this.currentFileIndex+1],this.currentFileIndex++}closeFullscreen(){(this.fileChanges.archive.length>0||this.fileChanges.delete.length>0)&&this.dialogOnClose?this.dialogUtils.displayConfirmation("Would you like to commit current changes?","Filtering Cancelled").afterClosed().subscribe(i=>{this.injectorService.closeFullscreenOverlay(i?{files:this.fileChanges,makeChanges:!0,continueFilter:!1}:{files:this.fileChanges,makeChanges:!1,continueFilter:!1})}):this.injectorService.closeFullscreenOverlay({files:this.fileChanges,makeChanges:!1,continueFilter:!1})}sendSelectedFiles(){this.loading=!0,this.dialogUtils.displayFilterConfirmation("Would you like to commit current changes?","Filtering Complete").afterClosed().subscribe(i=>{this.injectorService.closeFullscreenOverlay(this.dialogOnClose?"continue"===i?{files:this.fileChanges,makeChanges:!0,continueFilter:!0}:"commit"===i?{files:this.fileChanges,makeChanges:!0,continueFilter:!1}:{files:this.fileChanges,makeChanges:!1,continueFilter:!1}:{files:this.fileChanges,makeChanges:!0,continueFilter:!1})})}startAnimation(t){this.animationState||(this.animationState=t)}resetAnimationState(t){this.animationState=""}imageType(t){return!t?.includes("video")}playVideo(){this.videoPlayer.nativeElement.play()}downloadFile(t){this.fileService.downloadFile(t).subscribe({next:i=>{const s=document.createElement("a");document.body.appendChild(s);let a=window.URL.createObjectURL(i);s.href=a,s.download=`${t.hash}.${t.mime.substring(t.mime.indexOf("\\")+1)}`,s.click(),window.URL.revokeObjectURL(a),s.remove(),window.open(a)}})}openBottomSheet(t){this.bottomSheet.open(re,{data:{file:t},panelClass:"file-info-panel",closeOnNavigation:!0})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(O),e.Y36(c.uw),e.Y36(M),e.Y36(V.ch))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-overlay"]],viewQuery:function(t,i){if(1&t&&e.Gf(at,5),2&t){let s;e.iGM(s=e.CRH())&&(i.videoPlayer=s.first)}},decls:28,vars:4,consts:[[1,"main-container"],["fxLayout","center center",1,"top-buttons-container"],["mat-icon-button","",1,"close-fullscreen-button",3,"click"],["mat-icon-button","","class","play-video-button",3,"click",4,"ngIf"],["mat-icon-button","",1,"play-video-button",3,"click"],["fxLayoutAlign","center center","class","custom-swiper-container",3,"swipe","swipeleft","swiperight",4,"ngIf"],["mat-icon-button","",1,"delete-button",3,"click"],["mat-icon-button","",1,"archive-button",3,"click"],["fxLayout","row","fxLayoutAlign","space-evenly center"],["mat-icon-button","","matTooltip","go to previous file",1,"previous-button",3,"click"],["mat-icon-button","","matTooltip","download file",1,"download-button",3,"click"],["mat-icon-button","","matTooltip","skip current file",1,"skip-button",3,"click"],[1,"num-files-container"],["fxLayoutAlign","center center",1,"custom-swiper-container",3,"swipe","swipeleft","swiperight"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["video",""],["draggable","false",1,"current-image",3,"hidden","src","load"],["controls","",1,"current-video",3,"muted","hidden","loadeddata"],["videoPlayer",""],[3,"src","type"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"button",2),e.NdJ("click",function(){return i.closeFullscreen()}),e.TgZ(3,"mat-icon"),e._uU(4,"close"),e.qZA()(),e.YNc(5,lt,3,0,"button",3),e.TgZ(6,"button",4),e.NdJ("click",function(){return i.openBottomSheet(i.currentFile)}),e.TgZ(7,"mat-icon"),e._uU(8,"info"),e.qZA()()(),e.YNc(9,ut,5,4,"div",5),e.TgZ(10,"button",6),e.NdJ("click",function(){return i.sendToDelete()}),e.TgZ(11,"mat-icon"),e._uU(12,"delete"),e.qZA()(),e.TgZ(13,"button",7),e.NdJ("click",function(){return i.sendToArchive()}),e.TgZ(14,"mat-icon"),e._uU(15,"archive"),e.qZA()(),e.TgZ(16,"div",8)(17,"button",9),e.NdJ("click",function(){return i.sendToPrevious()}),e.TgZ(18,"mat-icon"),e._uU(19,"arrow_back"),e.qZA()(),e.TgZ(20,"button",10),e.NdJ("click",function(){return i.downloadFile(i.currentFile)}),e.TgZ(21,"mat-icon"),e._uU(22,"download"),e.qZA()(),e.TgZ(23,"button",11),e.NdJ("click",function(){return i.sendToSkip()}),e.TgZ(24,"mat-icon"),e._uU(25,"skip_next"),e.qZA()()(),e.TgZ(26,"div",12),e._uU(27),e.qZA()()),2&t&&(e.xp6(5),e.Q6J("ngIf",!i.imageType(null==i.currentFile?null:i.currentFile.mime)),e.xp6(4),e.Q6J("ngIf",i.currentFile),e.xp6(18),e.AsE(" ",i.currentFileIndex+1," / ",i.hydrusFiles.length," "))},dependencies:[h.O5,m.RK,J.Ou,x.Hw,E.gM,u.xw,u.Wh],styles:[".custom-swiper-container[_ngcontent-%COMP%]{height:87vh;width:90vw;padding:5px}.current-image[_ngcontent-%COMP%]{height:85vh;max-width:80vw;object-position:center;object-fit:contain}.current-video[_ngcontent-%COMP%]{width:87vw;height:85vh;object-position:center;object-fit:contain}.archive-button[_ngcontent-%COMP%]{position:absolute;height:87vh;width:55px;top:9%;right:25px}.delete-button[_ngcontent-%COMP%]{position:absolute;height:87vh;width:55px;left:25px;top:9%}.archive-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%], .delete-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%], .skip-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%], .previous-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%], .download-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:55px;height:55px;width:55px;line-height:55px;color:#00b0ff;text-shadow:0px 0px 1px black}.close-fullscreen-button[_ngcontent-%COMP%]{color:#ff4500;position:absolute;right:30px;font-size:35px;height:35px;width:35px;line-height:35px}.close-fullscreen-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:35px;height:35px;width:35px;line-height:35px}.play-video-button[_ngcontent-%COMP%]{color:#bb002f;font-size:45px;height:45px;width:45px;line-height:45px;margin-left:auto;margin-right:auto}.play-video-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:45px;height:45px;width:45px;line-height:45px}.num-files-container[_ngcontent-%COMP%]{position:absolute;right:15px;bottom:15px}.top-buttons-container[_ngcontent-%COMP%]{height:60px}"],data:{animation:[(0,g.X$)("cardAnimator",[(0,g.eR)("* => slideOutLeft",(0,g.jt)(855,(0,g.F4)(G))),(0,g.eR)("* => slideOutRight",(0,g.jt)(855,(0,g.F4)(W)))])]}}),n})();var I=r(3651),K=r(8484);class H{constructor(o,t){this.viewContainerRef=o,this.overlay=t}createGenericFullscreenOverlay(){const o=new I.X_;o.positionStrategy=this.overlay.position().global().centerHorizontally().centerVertically(),o.backdropClass="backdrop-class",o.scrollStrategy=this.overlay.scrollStrategies.block(),o.hasBackdrop=!0,this.overlayRef=this.overlay.create(o);const t=new K.C5(gt,this.viewContainerRef);this.overlayRef.attach(t)}createFullscreenOverlay(){const o=new I.X_;o.positionStrategy=this.overlay.position().global().centerHorizontally().centerVertically(),o.backdropClass="backdrop-class",o.scrollStrategy=this.overlay.scrollStrategies.block(),o.hasBackdrop=!0,this.overlayRef=this.overlay.create(o);const t=new K.C5(st,this.viewContainerRef);this.overlayRef.attach(t)}createMobileOverlay(){const o=new I.X_;o.positionStrategy=this.overlay.position().global().centerHorizontally().centerVertically(),o.backdropClass="backdrop-class",o.scrollStrategy=this.overlay.scrollStrategies.block(),o.hasBackdrop=!0,this.overlayRef=this.overlay.create(o);const t=new K.C5(Ee,this.viewContainerRef);this.overlayRef.attach(t)}closeOverlay(){this.overlayRef.dispose()}}let ce=(()=>{class n{static addToStorage(t,i){localStorage.setItem(n.thumbnailStorageName,JSON.stringify({height:t,width:i}))}static retrieveThumbnailDimensions(){return localStorage.getItem(n.thumbnailStorageName)||""}static clearStorage(){localStorage.removeItem(n.thumbnailStorageName)}}return n.thumbnailStorageName="thumbnail_dimensions",n})();var he=r(6593),P=r(4170),ue=r(2032),ge=r(6007),T=r(1887),_=r(6223),dt=r(5986),$=r(9488),pt=r(5066),mt=r(5195);function ft(n,o){1&n&&(e.TgZ(0,"mat-icon"),e._uU(1,"videocam"),e.qZA())}function _t(n,o){1&n&&(e.TgZ(0,"mat-icon"),e._uU(1,"volume_up"),e.qZA())}function vt(n,o){1&n&&(e.TgZ(0,"mat-icon"),e._uU(1," mail"),e.qZA())}function Ct(n,o){1&n&&(e.TgZ(0,"mat-icon"),e._uU(1," archive"),e.qZA())}function xt(n,o){1&n&&(e.TgZ(0,"mat-icon"),e._uU(1," delete"),e.qZA())}const X=function(n,o,t){return{background:n,"height.px":o,"width.px":t,"background-size":"contain"}};function yt(n,o){if(1&n&&e._UZ(0,"div",11),2&n){const t=e.oxw(3);e.Q6J("ngStyle",e.kEZ(1,X,"url("+t.hydrusFile.thumbnail_url+") no-repeat center center",t.heightNum,t.widthNum?t.widthNum:t.heightNum))}}const ee=function(n){return{"width.px":n}};function bt(n,o){if(1&n&&(e.TgZ(0,"div",11),e._UZ(1,"img",12),e.qZA()),2&n){const t=e.oxw(3);e.Q6J("ngStyle",e.kEZ(2,X,"url("+t.hydrusFile.thumbnail_url+") no-repeat center center",t.heightNum,t.widthNum?t.widthNum:t.heightNum)),e.xp6(1),e.Q6J("ngStyle",e.VKq(6,ee,t.widthNum?t.widthNum:t.heightNum))}}function Tt(n,o){if(1&n&&(e.TgZ(0,"div",11),e._UZ(1,"img",12),e.qZA()),2&n){const t=e.oxw(3);e.Q6J("ngStyle",e.kEZ(2,X,"url("+t.hydrusFile.thumbnail_url+") no-repeat center center",t.heightNum,t.widthNum?t.widthNum:t.heightNum)),e.xp6(1),e.Q6J("ngStyle",e.VKq(6,ee,t.widthNum?t.widthNum:t.heightNum))}}function Ft(n,o){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Oqu(t.hydrusFile.mime)}}function Ot(n,o){if(1&n&&(e.TgZ(0,"div")(1,"div",8),e.YNc(2,yt,1,5,"div",9),e.YNc(3,bt,2,8,"div",9),e.YNc(4,Tt,2,8,"div",9),e.YNc(5,Ft,2,1,"div",10),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngSwitch",t.fileType),e.xp6(1),e.Q6J("ngSwitchCase","image"),e.xp6(1),e.Q6J("ngSwitchCase","video"),e.xp6(1),e.Q6J("ngSwitchCase","gif")}}const St=function(n,o){return{"height.px":n,"width.px":o}};function wt(n,o){if(1&n&&e._UZ(0,"img",13),2&n){const t=e.oxw(2);e.Q6J("src",t.hydrusFile.file_url,e.LSH)("ngStyle",e.WLB(2,St,t.heightNum,t.widthNum?t.widthNum:t.heightNum))}}const At=function(n,o){return{"height.px":n,"width.px":o,"background-size":"contain"}};function Zt(n,o){if(1&n&&(e.TgZ(0,"div",1)(1,"mat-card",2)(2,"h3",3),e._uU(3),e.qZA(),e.TgZ(4,"div",4),e.YNc(5,ft,2,0,"mat-icon",5),e.YNc(6,_t,2,0,"mat-icon",5),e.YNc(7,vt,2,0,"mat-icon",5),e.YNc(8,Ct,2,0,"mat-icon",5),e.YNc(9,xt,2,0,"mat-icon",5),e.qZA(),e.YNc(10,Ot,6,4,"div",6),e.YNc(11,wt,1,5,"ng-template",null,7,e.W1O),e.qZA()()),2&n){const t=e.MAs(12),i=e.oxw();e.xp6(1),e.Q6J("ngStyle",e.WLB(11,At,i.heightNum+70,i.widthNum+50)),e.xp6(1),e.Q6J("ngStyle",e.VKq(14,ee,i.widthNum?i.widthNum:i.heightNum))("matTooltip",i.determineFileTitle()),e.xp6(1),e.hij(" ",i.determineFileTitle()," "),e.xp6(2),e.Q6J("ngIf",i.hydrusFile.has_audio),e.xp6(1),e.Q6J("ngIf",i.hydrusFile.has_audio),e.xp6(1),e.Q6J("ngIf",i.hydrusFile.is_inbox),e.xp6(1),e.Q6J("ngIf",!i.hydrusFile.is_inbox),e.xp6(1),e.Q6J("ngIf",i.hydrusFile.is_trashed),e.xp6(1),e.Q6J("ngIf",i.thumbnail)("ngIfElse",t)}}let de=(()=>{class n{constructor(){this.fileType="",this.heightNum=0,this.widthNum=0}ngOnInit(){this.hydrusFile.mime.includes("video")?(this.fileType="video",this.thumbnail=!0):this.hydrusFile.mime.includes("gif")?(this.fileType="gif",this.thumbnail=!0):this.hydrusFile.mime.includes("image")?this.fileType="image":this.thumbnail=!0}determineFileTitle(){let t="";return this.hydrusFile.tags["616c6c206b6e6f776e2074616773"].display_tags[0].forEach(i=>{i.includes("series")&&(t+=i.substring(i.indexOf(":")+1)+", ")}),t.trimEnd().slice(0,-1)}isPlayable(t){return!(!t.mime.includes("video")&&!t.mime.includes("gif"))}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-image-display"]],inputs:{hydrusFile:"hydrusFile",heightNum:"heightNum",widthNum:"widthNum",thumbnail:"thumbnail"},decls:1,vars:1,consts:[["fxLayoutAlign","center center","class","card-container",4,"ngIf"],["fxLayoutAlign","center center",1,"card-container"],["id","image-container","fxLayoutAlign","start center","fxLayout","column",3,"ngStyle"],[1,"file-title",3,"ngStyle","matTooltip"],["fxLayout","row","draggable","false"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["hdImage",""],[3,"ngSwitch"],["draggable","false","fxLayoutAlign","center center",3,"ngStyle",4,"ngSwitchCase"],[4,"ngSwitchDefault"],["draggable","false","fxLayoutAlign","center center",3,"ngStyle"],["src","assets/images/video-play-button.png",1,"video-play-button",3,"ngStyle"],["draggable","false",1,"image-thumbnail",3,"src","ngStyle"]],template:function(t,i){1&t&&e.YNc(0,Zt,13,16,"div",0),2&t&&e.Q6J("ngIf",i.hydrusFile)},dependencies:[h.O5,h.PC,h.RF,h.n9,h.ED,mt.a8,x.Hw,E.gM,u.xw,u.Wh,A.Zl],styles:[".image-thumbnail[_ngcontent-%COMP%]{object-fit:contain;width:95%;height:95%;animation:fadeIn ease .5s}.file-title[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-align:center;font-variant:small-caps;font-weight:700;font-size:20px;margin:0;width:85%}#image-container[_ngcontent-%COMP%]{padding:0;box-shadow:unset!important;border-radius:unset!important}.video[_ngcontent-%COMP%]{object-fit:fill}.video-play-button[_ngcontent-%COMP%]{opacity:.75}"]}),n})();function It(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"bar-rating",17),e.NdJ("rateChange",function(s){e.CHM(t);const a=e.oxw().$implicit,l=e.oxw(2);return e.KtG(l.selectRating(a,s,l.overallRating))}),e.qZA()}if(2&n){const t=e.oxw(3);e.Q6J("max",t.ratings[t.overallRating].max_stars)}}const kt=function(n){return{border:n}};function Mt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",10)(1,"button",11),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.fullscreenView(a))})("color",function(){const a=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.isPlayable(a))}),e.TgZ(2,"mat-icon"),e._uU(3,"zoom_in"),e.qZA()(),e.TgZ(4,"div",12),e.NdJ("click",function(s){const l=e.CHM(t).$implicit,d=e.oxw(2);return e.KtG(d.selectFile(l,s))})("auxclick",function(s){const l=e.CHM(t).$implicit,d=e.oxw(2);return e.KtG(d.onAuxClick(l,s))})("contextmenu",function(s){return s.preventDefault()}),e._UZ(5,"app-image-display",13),e.qZA(),e.TgZ(6,"div",14)(7,"mat-button-toggle",15),e.NdJ("change",function(s){const l=e.CHM(t).$implicit,d=e.oxw(2);return e.KtG(d.selectRating(l,s.source._checked,d.likeRating))}),e.TgZ(8,"mat-icon"),e._uU(9,"thump_up"),e.qZA()(),e.TgZ(10,"mat-button-toggle",15),e.NdJ("change",function(s){const l=e.CHM(t).$implicit,d=e.oxw(2);return e.KtG(d.selectRating(l,s.source._checked,d.favouriteRating))}),e.TgZ(11,"mat-icon"),e._uU(12,"favorite"),e.qZA()(),e.YNc(13,It,1,1,"bar-rating",16),e.qZA()()}if(2&n){const t=o.$implicit,i=e.oxw(2);e.xp6(4),e.Q6J("ngStyle",e.VKq(6,kt,i.isFileSelected(t))),e.xp6(1),e.Q6J("hydrusFile",t)("widthNum",i.itemWidth)("heightNum",i.itemHeight)("thumbnail",!1),e.xp6(8),e.Q6J("ngIf",i.ratings)}}function Pt(n,o){if(1&n&&(e.TgZ(0,"div",8),e.YNc(1,Mt,14,8,"div",9),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("ngForOf",t)}}const Dt=function(n){return{"height.px":n}};let Nt=(()=>{class n{constructor(t,i,s,a,l,d){this.injectorService=s,this.viewportRuler=a,this.ngZone=l,this.fileService=d,this.filesChanged=new e.vpe,this.localStorageUtil=ce,this.itemSet=[],this.h=0,this.enumUtil=D,this.rate=5,this.overlayUtil=new H(t,i),this.currentIndex=0,this.fileChanges=new L,this.subscriptions=[],this.ratingChanges=[],this.likeRating="",this.overallRating="",this.favouriteRating="",this.continueFilter=!1,this.continue=!0,this.chunkSize=1}ngOnChanges(t){t.itemWidth?(this.itemWidth=t.itemWidth.currentValue,this.generateDataChunk(this.hydrusFiles)):t.itemHeight&&(this.itemWidth=t.itemHeight.currentValue,this.generateDataChunk(this.hydrusFiles)),this.ratings&&Object.keys(this.ratings).forEach(i=>{this.ratings[i].name==this.enumUtil.ratingServices.OVERALL?(this.overallRating=i,console.log(i+" - "+this.ratings[i].name)):this.ratings[i].name==this.enumUtil.ratingServices.LIKE?(this.likeRating=i,console.log(i+" - "+this.ratings[i].name)):this.ratings[i].name==this.enumUtil.ratingServices.FAV&&(this.favouriteRating=i,console.log(i+" - "+this.ratings[i].name))})}ngOnDestroy(){this.subscriptions.forEach(t=>{t.unsubscribe()}),this.viewportChangeSub.unsubscribe()}ngOnInit(){let t=this.localStorageUtil.retrieveThumbnailDimensions();if(t){let i=JSON.parse(t);this.itemHeight=i.height,this.itemWidth=i.width}else this.localStorageUtil.addToStorage(this.itemHeight,this.itemWidth);this.generateDataChunk(this.hydrusFiles),this.viewportChangeSub=this.viewportRuler.change(200).subscribe(()=>this.ngZone.run(()=>this.generateDataChunk(this.hydrusFiles)))}generateDataChunk(t){this.calcChunkSize();let i,s=[];for(i=0;i<t.length;i+=this.chunkSize)s.push(t.slice(i,i+this.chunkSize));this.itemSet=s}calcChunkSize(){let t=window.innerWidth;this.chunkSize=Math.floor(t/(this.itemWidth+100)),this.h=Math.ceil(this.hydrusFiles.length/this.chunkSize)*(this.itemHeight+205)}fullscreenView(t){this.overlayUtil.createFullscreenOverlay(),this.currentIndex=this.hydrusFiles.indexOf(t),this.setupFileChanges(),setTimeout(()=>this.injectorService.announceFullscreenOverlay({files:this.hydrusFiles,currentIndex:this.hydrusFiles.indexOf(t),currentFileChanges:this.fileChanges,dialogOnClose:!1}),300),this.subscriptions.push(this.injectorService.sendFilesSourceFound$.subscribe(i=>{i.continueFilter?this.continueFilter=!0:(this.overlayUtil.closeOverlay(),this.continueFilter=!1),i.makeChanges&&i.files.archive.length+i.files.delete.length+i.files.skipped.length===this.hydrusFiles.length?this.filesChanged.emit({userFiles:this.fileChanges,userFileRatings:this.ratingChanges,continue:this.continue}):this.fileChanges=i.files}))}isPlayable(t){return t.mime.includes("video")||t.mime.includes("gif")?"warn":"accent"}onAuxClick(t,i){this.currentIndex=this.hydrusFiles.indexOf(t),2===i.button&&(this.fileChanges.skipped.includes(t)?this.fileChanges.skipped.splice(this.fileChanges.archive.indexOf(t),1):this.fileChanges.skipped.push(t),this.fileChanges.archive.includes(t)&&this.fileChanges.archive.splice(this.fileChanges.archive.indexOf(t),1))}selectFile(t,i){this.currentIndex=this.hydrusFiles.indexOf(t),this.fileChanges.archive.includes(t)?this.fileChanges.archive.splice(this.fileChanges.archive.indexOf(t),1):this.fileChanges.archive.push(t),this.fileChanges.skipped.includes(t)&&this.fileChanges.skipped.splice(this.fileChanges.skipped.indexOf(t),1)}selectRating(t,i,s){if(this.currentIndex=this.hydrusFiles.indexOf(t),this.ratingChanges.find(a=>a.hash===t.hash)){let a=this.ratingChanges.findIndex(l=>l.hash===t.hash);this.ratingChanges[a].rating=i}else this.ratingChanges.push(new xe(t.hash,s,i))}isFileSelected(t){return this.fileChanges.archive.includes(t)?"8px solid #00e676":this.fileChanges.skipped.includes(t)?"8px solid  #007ac1":"8px solid #424242"}setupFileChanges(){let t=[];t=this.currentIndex!=this.hydrusFiles.length-1?this.hydrusFiles.slice(0,this.currentIndex):this.hydrusFiles,this.fileChanges.delete=[],this.fileChanges.archive.length>0&&this.fileChanges.skipped.length>0?(this.fileChanges.delete=t.filter(i=>!this.fileChanges.archive.map(s=>s.file_id).includes(i.file_id)),this.fileChanges.delete=this.fileChanges.delete.filter(i=>!this.fileChanges.skipped.map(s=>s.file_id).includes(i.file_id))):this.fileChanges.delete=this.fileChanges.archive.length>0?t.filter(i=>!this.fileChanges.archive.map(s=>s.file_id).includes(i.file_id)):this.fileChanges.skipped.length>0?t.filter(i=>!this.fileChanges.skipped.map(s=>s.file_id).includes(i.file_id)):t}downloadFile(t){this.fileService.downloadFile(t).subscribe({next:i=>{const s=document.createElement("a");document.body.appendChild(s);let a=window.URL.createObjectURL(i);s.href=a,s.download=`${t.hash}.${t.mime.substring(t.mime.indexOf("\\")+1)}`,s.click(),window.URL.revokeObjectURL(a),s.remove(),window.open(a)}})}submitFiles(){this.currentIndex=this.hydrusFiles.length-1,this.setupFileChanges(),this.filesChanged.emit({userFiles:this.fileChanges,userFileRatings:this.ratingChanges,continue:this.continue})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.s_b),e.Y36(I.aV),e.Y36(O),e.Y36(T.rL),e.Y36(e.R0b),e.Y36(M))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-image-display-chunk-select-list"]],inputs:{hydrusFiles:"hydrusFiles",ratings:"ratings",itemHeight:"itemHeight",itemWidth:"itemWidth"},outputs:{filesChanged:"filesChanged"},features:[e.TTD],decls:21,vars:12,consts:[["appendOnly","",1,"virtual-container",3,"itemSize","minBufferPx","maxBufferPx","ngStyle"],["class","virtual-row-items","fxLayout","row wrap","fxLayoutAlign","center center","fxLayoutGap","15px",4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTemplateCacheSize"],["id","dark-mode-divider",1,"view-divider"],["fxLayoutAlign","start center","fxLayout","row","fxLayoutGap","30px"],["fxLayoutAlign","center center"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","25px",1,"select-list-footer-container"],["mat-flat-button","","color","primary",1,"submit-button",3,"click"],[1,"continue-checkbox",3,"ngModel","ngModelChange"],["fxLayout","row wrap","fxLayoutAlign","center center","fxLayoutGap","15px",1,"virtual-row-items"],["class","files-container",4,"ngFor","ngForOf"],[1,"files-container"],["mat-mini-fab","","fxLayout","column","fxLayoutAlign","center center",1,"change-view-button",3,"click","color"],[1,"image-display-container",3,"ngStyle","click","auxclick","contextmenu"],[3,"hydrusFile","widthNum","heightNum","thumbnail"],["fxLayout","row","fxLayoutGap","5px",1,"ratings-container"],[1,"like-button",3,"change"],["name","rating",3,"max","rateChange",4,"ngIf"],["name","rating",3,"max","rateChange"]],template:function(t,i){1&t&&(e.TgZ(0,"cdk-virtual-scroll-viewport",0),e.YNc(1,Pt,2,1,"div",1),e.qZA(),e._UZ(2,"mat-divider",2),e.TgZ(3,"div",3)(4,"p",4)(5,"mat-icon"),e._uU(6,"archive"),e.qZA(),e._uU(7),e.qZA(),e.TgZ(8,"p",4)(9,"mat-icon"),e._uU(10,"delete"),e.qZA(),e._uU(11),e.qZA(),e.TgZ(12,"p",4)(13,"mat-icon"),e._uU(14,"skip_next"),e.qZA(),e._uU(15),e.qZA()(),e.TgZ(16,"div",5)(17,"button",6),e.NdJ("click",function(){return i.submitFiles()}),e._uU(18," Submit "),e.qZA(),e.TgZ(19,"mat-checkbox",7),e.NdJ("ngModelChange",function(a){return i.continue=a}),e._uU(20,"Continue Filtering"),e.qZA()()),2&t&&(e.Q6J("itemSize",i.itemHeight)("minBufferPx",3*i.itemHeight)("maxBufferPx",5*i.itemHeight)("ngStyle",e.VKq(10,Dt,i.h)),e.xp6(1),e.Q6J("cdkVirtualForOf",i.itemSet)("cdkVirtualForTemplateCacheSize",0),e.xp6(6),e.hij(" ",i.fileChanges.archive.length," "),e.xp6(4),e.hij(" ",i.hydrusFiles.length-(i.fileChanges.archive.length+i.fileChanges.skipped.length)," "),e.xp6(4),e.hij(" ",i.fileChanges.skipped.length," "),e.xp6(4),e.Q6J("ngModel",i.continue))},dependencies:[h.sg,h.O5,h.PC,m.lW,m.nh,F.d,dt.oG,x.Hw,$.Yi,T.xd,T.x0,T.N7,u.xw,u.SQ,u.Wh,A.Zl,_.JJ,_.On,pt.OJ,de],styles:[".file-filter-container[_ngcontent-%COMP%]{margin:-25px 8px 8px}.change-view-button[_ngcontent-%COMP%]{position:relative;left:81%;top:47px;z-index:1;width:74px;height:39px}.image-display-container[_ngcontent-%COMP%]{cursor:pointer}.submit-button[_ngcontent-%COMP%]{width:185px;color:#f5f5f5;text-shadow:0px 0px 1px black}.virtual-container[_ngcontent-%COMP%]{width:100%;height:100%;flex-grow:1}.virtual-row-items[_ngcontent-%COMP%], .files-container[_ngcontent-%COMP%]{margin:10px}.view-divider[_ngcontent-%COMP%]{margin-top:21px!important}.select-list-footer-container[_ngcontent-%COMP%]{margin-bottom:25px}.mat-button-toggle-checked[_ngcontent-%COMP%]{background-color:green!important}"]}),n})();function Ut(n,o){1&n&&(e.TgZ(0,"p",6),e._uU(1," Processing Filter... "),e.qZA())}function Lt(n,o){if(1&n&&(e.TgZ(0,"div",3),e._UZ(1,"mat-progress-bar",4),e.YNc(2,Ut,2,0,"p",5),e.qZA()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",t.processing)}}const pe=function(){return{updateOn:"blur"}};function Jt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",7)(1,"div",8)(2,"mat-form-field",9)(3,"mat-label"),e._uU(4," Thumbnail Height "),e.qZA(),e.TgZ(5,"input",10),e.NdJ("ngModelChange",function(s){e.CHM(t);const a=e.oxw();return e.KtG(a.thumbnailHeight=s)})("ngModelChange",function(s){e.CHM(t);const a=e.oxw();return e.KtG(a.updateHeight(s))}),e.qZA()(),e.TgZ(6,"mat-form-field",9)(7,"mat-label"),e._uU(8," Thumbnail Width "),e.qZA(),e.TgZ(9,"input",10),e.NdJ("ngModelChange",function(s){e.CHM(t);const a=e.oxw();return e.KtG(a.thumbnailWidth=s)})("ngModelChange",function(s){e.CHM(t);const a=e.oxw();return e.KtG(a.updateWidth(s))}),e.qZA()()(),e.TgZ(10,"div",11)(11,"div",12)(12,"div",13),e._UZ(13,"p",14)(14,"img",15),e.TgZ(15,"p"),e._uU(16,"Archive"),e.qZA()(),e.TgZ(17,"div",13),e._UZ(18,"p",16)(19,"img",17),e.TgZ(20,"p"),e._uU(21,"Skip"),e.qZA()(),e.TgZ(22,"div",13),e._UZ(23,"p",18)(24,"img",19),e.TgZ(25,"p"),e._uU(26,"Delete (not selected)"),e.qZA()()()(),e.TgZ(27,"div")(28,"app-image-display-chunk-select-list",20),e.NdJ("filesChanged",function(s){e.CHM(t);const a=e.oxw();return e.KtG(a.updateFileStatuses(s))}),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(5),e.Q6J("ngModel",t.thumbnailHeight)("ngModelOptions",e.DdM(8,pe)),e.xp6(4),e.Q6J("ngModel",t.thumbnailWidth)("ngModelOptions",e.DdM(9,pe)),e.xp6(19),e.Q6J("hydrusFiles",t.hydrusFiles)("itemHeight",t.thumbnailHeight)("itemWidth",t.thumbnailWidth)("ratings",t.ratingService)}}let Rt=(()=>{class n{constructor(t,i,s,a,l,d,oe){this.router=t,this.apiService=s,this.fileService=a,this.injectorService=l,this.sortDir=!0,this.loading=!0,this.enumUtil=D,this.processing=!1,this.localStorageUtil=ce,i.setTitle("Archive/Delete | "+le.N.app_name),this.hydrusFiles=[],this.subscriptions=[],this.searchTags=[],this.currentIndex=0,this.sortType=0,this.overlayUtil=new H(d,oe),this.continueFilter=!1,this.thumbnailWidth=365,this.thumbnailHeight=330,this.continue=!0,this.router.getCurrentNavigation()?.extras.state&&(this.hydrusFiles=this.router.getCurrentNavigation()?.extras.state?.files,this.searchTags=this.router.getCurrentNavigation()?.extras.state?.tags,"false"===this.router.getCurrentNavigation()?.extras.state?.sortDir&&(this.sortDir=!1),this.router.getCurrentNavigation(),this.setSearchParams(),this.saveSearchParams(),this.loading=!1),this.subscriptions.push(this.router.events.subscribe(U=>{if(console.log(U),U instanceof y.m2){console.log("navend");let S=encodeURI(U.url);console.log(S)}}))}ngOnDestroy(){this.subscriptions.forEach(t=>{t.unsubscribe()})}ngOnInit(){this.apiService.getServices().subscribe(i=>{this.ratingService=i.services}),0===this.hydrusFiles.length&&this.searchFiles();let t=this.localStorageUtil.retrieveThumbnailDimensions();if(t){let i=JSON.parse(t);this.thumbnailHeight=i.height,this.thumbnailWidth=i.width}else this.localStorageUtil.addToStorage(this.thumbnailHeight,this.thumbnailWidth)}searchFiles(){this.continue?(this.processing=!1,this.loading=!0,this.hydrusFiles=[],this.subscriptions.push(this.apiService.getFilesSearch(this.searchTags,this.sortType.toString(),this.sortDir.toString()).subscribe({next:t=>{this.fileService.getThumbnailAndMetadata(t.file_ids).subscribe({next:i=>{this.hydrusFiles=i,this.loading=!1}})}})),this.setSearchParams(),this.saveSearchParams()):this.router.navigate(["/file-search"])}setSearchParams(){let t=`?tags=${this.searchTags.flat()}&sortType=${this.sortType}&sortDir=${this.sortDir}`;this.searchParams=new URLSearchParams(t)}saveSearchParams(){var t=window.location.pathname+"?"+this.searchParams.toString();history.pushState(null,"",t)}updateFileStatuses(t){this.processing=!0,this.loading=!0;let i=t.userFiles.archive.map(a=>a.file_id),s=t.userFiles.delete.map(a=>a.file_id);this.continue=t.continue,i.length>0&&s.length>0?this.subscriptions.push((0,ae.D)([this.apiService.archiveMultipleFilesById(i),this.apiService.deleteMultipleFilesById(s)]).subscribe({next:a=>{this.searchFiles()},error:a=>{console.log(a)}})):s.length>0?this.apiService.deleteMultipleFilesById(s).subscribe({next:a=>{this.searchFiles()},error:a=>{console.log(a)}}):i.length>0&&this.apiService.archiveMultipleFilesById(i).subscribe({next:a=>{this.searchFiles()},error:a=>{console.log(a)}}),t.userFileRatings.length>0&&t.userFileRatings.forEach(a=>{this.apiService.setFileRatings(a).subscribe({next:l=>{console.log(l)},error:l=>{console.log(l)}})})}updateHeight(t){this.localStorageUtil.addToStorage(t,this.thumbnailWidth)}updateWidth(t){this.localStorageUtil.addToStorage(this.thumbnailHeight,t)}scrollToTop(){window.scrollTo({top:0,behavior:"smooth"})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(y.F0),e.Y36(he.Dx),e.Y36(Y.s),e.Y36(M),e.Y36(O),e.Y36(e.s_b),e.Y36(I.aV))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-archive-delete-filter-select-list"]],decls:3,vars:2,consts:[["fxLayout","column","cdkVirtualScrollingElement","","id","scrolling-element-container",1,"main-container"],["fxLayout","column","class","loading-container",4,"ngIf"],["fxLayout","column",4,"ngIf"],["fxLayout","column",1,"loading-container"],["mode","indeterminate"],["matLine","","class","processing-text",4,"ngIf"],["matLine","",1,"processing-text"],["fxLayout","column"],["fxLayout","row wrap","fxLayout","center center","fxLayoutGap","10px"],["appearance","outline",1,"thumbnail-form-field"],["matInput","","type","number",3,"ngModel","ngModelOptions","ngModelChange"],["fxLayout","column","fxLayoutAlign","center center",1,"legend-container"],["fxLayout","row wrap","fxLayoutGap","20px"],["fxLayout","row wrap","fxLayoutAlign","center center","fxLayoutGap","5px"],["id","selected-color",1,"color-block"],["src","assets/custom-icons/left-click.png",1,"mouse-button-icons"],["id","skip-color",1,"color-block"],["src","assets/custom-icons/right-click.png",1,"mouse-button-icons"],["id","delete-color",1,"color-block"],["src","assets/custom-icons/no-click.png",1,"mouse-button-icons"],[3,"hydrusFiles","itemHeight","itemWidth","ratings","filesChanged"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,Lt,3,1,"div",1),e.YNc(2,Jt,29,10,"div",2),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",i.loading),e.xp6(1),e.Q6J("ngIf",!i.loading))},dependencies:[h.O5,P.KE,P.hX,ue.Nt,N.X2,ge.pW,T.j8,u.xw,u.SQ,u.Wh,_.Fj,_.wV,_.JJ,_.On,Nt],styles:[".color-block[_ngcontent-%COMP%]{width:30px;height:5px}#selected-color[_ngcontent-%COMP%]{background-color:#00e676}#skip-color[_ngcontent-%COMP%]{background-color:#007ac1}#delete-color[_ngcontent-%COMP%]{background-color:transparent;border:1px solid #424242}.mouse-button-icons[_ngcontent-%COMP%]{width:auto;height:20px;position:relative;top:-5px}.file-statuses[_ngcontent-%COMP%]{margin-left:auto;margin-right:25px;margin-bottom:-8px}.processing-text[_ngcontent-%COMP%]{text-align:center;margin-top:25px;font-size:25px}.loading-container[_ngcontent-%COMP%]{margin-top:15px}.thumbnail-form-field[_ngcontent-%COMP%]{text-align:center;width:125px;font-size:15px}.legend-container[_ngcontent-%COMP%]{margin-top:-63px;margin-bottom:10px}.scroll-top-button[_ngcontent-%COMP%]{position:fixed;bottom:11px;right:24px;border-radius:45%}#scrolling-element-container[_ngcontent-%COMP%]{height:calc(100vh - 105px)}"]}),n})();var te=r(1088);function Yt(n,o){1&n&&(e.TgZ(0,"span"),e._uU(1," / "),e.qZA())}function Et(n,o){1&n&&(e.TgZ(0,"mat-icon"),e._uU(1,"play_arrow"),e.qZA())}function Ht(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",4)(1,"button",5),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.fullscreenView(a))}),e.TgZ(2,"mat-icon"),e._uU(3,"zoom_in"),e.qZA(),e.YNc(4,Yt,2,0,"span",6),e.YNc(5,Et,2,0,"mat-icon",6),e.qZA(),e.TgZ(6,"div",7),e._UZ(7,"app-image-display",8),e.qZA()()}if(2&n){const t=o.$implicit,i=e.oxw(2);e.xp6(4),e.Q6J("ngIf",i.isPlayable(t)),e.xp6(1),e.Q6J("ngIf",i.isPlayable(t)),e.xp6(2),e.Q6J("hydrusFile",t)("widthNum",i.itemWidth)("heightNum",i.itemHeight)("thumbnail",!0)}}function Qt(n,o){if(1&n&&(e.TgZ(0,"div",2),e.YNc(1,Ht,8,6,"div",3),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("ngForOf",t)}}let qt=(()=>{class n{constructor(t,i,s,a,l){this.viewportRuler=t,this.ngZone=i,this.injectorService=l,this.itemSet=[],this.currentIndex=0,this.overlayUtil=new H(a,s),this.itemHeight=230,this.itemWidth=265,this.chunkSize=1}ngOnInit(){this.calcChunkSize(),this.generateDataChunk(this.hydrusFiles),this.viewportChangeSub=this.viewportRuler.change(200).subscribe(()=>this.ngZone.run(()=>this.generateDataChunk(this.hydrusFiles)))}ngOnDestroy(){this.viewportChangeSub.unsubscribe()}generateDataChunk(t){this.calcChunkSize();let i,s=[];for(i=0;i<t.length;i+=this.chunkSize)s.push(t.slice(i,i+this.chunkSize));this.itemSet=s}getItemDimensions(){this.itemHeight=230,this.itemWidth=265}calcChunkSize(){let t=window.innerWidth;this.chunkSize=Math.floor(t/(this.itemWidth+50))-1}isPlayable(t){return!(!t.mime.includes("video")&&!t.mime.includes("gif"))}fullscreenView(t){this.overlayUtil.createGenericFullscreenOverlay(),this.currentIndex=this.hydrusFiles.indexOf(t),setTimeout(()=>this.injectorService.announceFullscreenOverlay({files:this.hydrusFiles,currentIndex:this.hydrusFiles.indexOf(t),dialogOnClose:!1}),300)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(T.rL),e.Y36(e.R0b),e.Y36(I.aV),e.Y36(e.s_b),e.Y36(O))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-image-display-chunk"]],inputs:{hydrusFiles:"hydrusFiles"},decls:2,vars:5,consts:[[1,"virtual-container",3,"itemSize","minBufferPx","maxBufferPx"],["class","virtual-row-items","fxLayout","row wrap","fxLayoutAlign","center center","fxLayoutGap","15px",4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTemplateCacheSize"],["fxLayout","row wrap","fxLayoutAlign","center center","fxLayoutGap","15px",1,"virtual-row-items"],["class","files-container",4,"ngFor","ngForOf"],[1,"files-container"],["mat-flat-button","","color","accent","fxLayout","column","fxLayoutAlign","center center",1,"change-view-button",3,"click"],[4,"ngIf"],[1,"image-display-container"],[3,"hydrusFile","widthNum","heightNum","thumbnail"]],template:function(t,i){1&t&&(e.TgZ(0,"cdk-virtual-scroll-viewport",0),e.YNc(1,Qt,2,1,"div",1),e.qZA()),2&t&&(e.Q6J("itemSize",i.itemHeight)("minBufferPx",2*i.itemHeight)("maxBufferPx",4*i.itemHeight),e.xp6(1),e.Q6J("cdkVirtualForOf",i.itemSet)("cdkVirtualForTemplateCacheSize",0))},dependencies:[h.sg,h.O5,m.lW,x.Hw,T.xd,T.x0,T.N7,u.xw,u.SQ,u.Wh,de],styles:[".virtual-container[_ngcontent-%COMP%]{width:100%;height:100%}.virtual-row-items[_ngcontent-%COMP%], .files-container[_ngcontent-%COMP%]{margin:10px}.image-display-container[_ngcontent-%COMP%]{cursor:pointer}"]}),n})(),jt=(()=>{class n{constructor(t,i){this.dialogRef=t,this.data=i}onNoClick(){this.dialogRef.close()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(c.so),e.Y36(c.WI))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-dialog-edit-tag"]],decls:12,vars:2,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["appearance","fill"],["matInput","",3,"ngModel","ngModelChange"],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","","cdkFocusInitial","",3,"mat-dialog-close"]],template:function(t,i){1&t&&(e.TgZ(0,"h1",0),e._uU(1,"Edit Tag"),e.qZA(),e.TgZ(2,"div",1)(3,"mat-form-field",2)(4,"mat-label"),e._uU(5,"Tag"),e.qZA(),e.TgZ(6,"input",3),e.NdJ("ngModelChange",function(a){return i.data.tag=a}),e.qZA()()(),e.TgZ(7,"div",4)(8,"button",5),e.NdJ("click",function(){return i.onNoClick()}),e._uU(9,"Cancel"),e.qZA(),e.TgZ(10,"button",6),e._uU(11,"Update"),e.qZA()()),2&t&&(e.xp6(6),e.Q6J("ngModel",i.data.tag),e.xp6(4),e.Q6J("mat-dialog-close",i.data.tag))},dependencies:[m.lW,P.KE,P.hX,ue.Nt,c.ZT,c.uh,c.xY,c.H8,_.Fj,_.JJ,_.On]}),n})();var me=r(6028),p=(()=>((p=p||{}).fileSize="File Size",p.duration="Duration",p.importTime="Import Time",p.random="Random",p.lastViewedTime="Last Viewed Time",p.archiveTimestamp="Archive Timestamp",p))();class Q{static get getSortTypeArray(){return Object.values(p)}static get sortTypes(){return p}static findSortTypeInt(o){return this.sortTypeMap.get(o)}static getByValue(o){for(let[t,i]of Q.sortTypeMap.entries())if(i===o)return t;return""}}Q.sortTypeMap=new Map([[p.fileSize,0],[p.duration,1],[p.importTime,2],[p.random,4],[p.lastViewedTime,18],[p.archiveTimestamp,19]]);var Gt=r(7921),Wt=r(8525),fe=r(4630);const Bt=["tagInput"],Vt=["auto"];function zt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"mat-chip",15),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.chipSelected(a))})("removed",function(){const a=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.removeSearchTag(a))}),e._uU(1),e.TgZ(2,"mat-icon",16),e._uU(3,"cancel"),e.qZA()()}if(2&n){const t=o.$implicit,i=e.oxw();e.Q6J("removable",!0)("ngClass","tag-namespace-"+(i.tagUtils.getNamespaceNoSpace(t)?i.tagUtils.getNamespaceNoSpace(t):"default")),e.xp6(1),e.hij(" ",t," ")}}function Kt(n,o){if(1&n&&(e.TgZ(0,"mat-option",17),e._uU(1),e.qZA()),2&n){const t=o.$implicit,i=e.oxw();e.Q6J("value",t)("ngClass","tag-namespace-"+i.tagUtils.getNamespaceNoSpace(t)),e.xp6(1),e.hij(" ",t," ")}}function $t(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"mat-option",18),e.NdJ("onSelectionChange",function(s){e.CHM(t);const a=e.oxw();return e.KtG(a.sortSelectionChange(s))}),e._uU(1),e.qZA()}if(2&n){const t=o.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t)}}let Xt=(()=>{class n{constructor(t,i){this.fileService=t,this.dialog=i,this.searchTags=[],this.separatorKeysCodes=[me.K5,me.OC],this.tagUtils=Z,this.sortingUtils=Q,this.tagCtrl=new _.NI,this.tags=new e.vpe,this.sortType=new e.vpe,this.sortDir=new e.vpe,this.sortTypes=this.sortingUtils.getSortTypeArray,this.selectedSort=this.sortingUtils.sortTypes.importTime,this.sortTypeNum=this.sortingUtils.findSortTypeInt(this.sortingUtils.sortTypes.importTime),this.selectedDir=!1,this.filteredTags=this.tagCtrl.valueChanges.pipe((0,Gt.O)(""),(0,z.U)(s=>this._filter(s)))}ngOnInit(){this.initalTags&&(this.searchTags=this.initalTags,this.tags.emit(this.searchTags)),this.initalSortType&&(this.sortTypeNum=this.initalSortType,this.selectedSort=this.sortingUtils.getByValue(this.initalSortType)),this.initalSortDir&&(this.selectedDir=this.initalSortDir)}chipInputEvent(t){if(this.matAutocomplete.isOpen&&this.matAutocomplete.options.some(a=>a.active))return;const i=t.chipInput.inputElement,s=t.value.toLowerCase();this.addSearchTag(s),i&&(i.value=""),this.tagCtrl.setValue(null)}addSearchTag(t){const i=t.toLowerCase();(i||"").trim()&&this.searchTags.push(i),this.tags.emit(this.searchTags)}removeSearchTag(t){const i=this.searchTags.indexOf(t);i>=0&&this.searchTags.splice(i,1),this.tags.emit(this.searchTags)}selected(t){this.addSearchTag(t.option.viewValue),this.tagInput.nativeElement.value="",this.tagCtrl.setValue(null)}chipSelected(t){this.dialog.open(jt,{width:"250px",data:{tag:t}}).afterClosed().subscribe(s=>{const a=this.searchTags.indexOf(t);a>=0&&this.searchTags.splice(a,1),this.addSearchTag(s)})}_filter(t){let i=t?t.toLowerCase():"";const s=i.startsWith("-");s&&(i=i.substring(1));let a=Array.from(this.fileService.getKnownTags()).filter(l=>-1!==l.toLowerCase().indexOf(i)).filter(l=>!this.searchTags.includes(l)).slice(0,25);return s&&(a=a.map(l=>`-${l}`)),console.log(a),a}sortSelectionChange(t){t.isUserInput&&this.sortType.emit(this.sortingUtils.findSortTypeInt(t.source.value))}changeSortDirection(t){this.selectedDir=!this.selectedDir,this.sortDir.emit(this.selectedDir)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(M),e.Y36(c.uw))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-search-tag-input"]],viewQuery:function(t,i){if(1&t&&(e.Gf(Bt,5),e.Gf(Vt,5)),2&t){let s;e.iGM(s=e.CRH())&&(i.tagInput=s.first),e.iGM(s=e.CRH())&&(i.matAutocomplete=s.first)}},inputs:{initalTags:"initalTags",initalSortType:"initalSortType",initalSortDir:"initalSortDir"},outputs:{tags:"tags",sortType:"sortType",sortDir:"sortDir"},decls:20,vars:11,consts:[["fxLayoutGap.lt-md","5px","fxLayoutAlign.lt-md","center start","fxLayout.lt-md","column","fxLayoutGap.gt-sm","10px","fxLayoutAlign.gt-sm","center center","fxLayout.gt-sm","row"],[1,"tag-form-field"],["aria-label","Tag Search"],["chipList",""],["class","tag-chip","color","primary",3,"removable","ngClass","click","removed",4,"ngFor","ngForOf"],["placeholder","Tag Search","matChipInputAddOnBlur","false",3,"matChipInputFor","matChipInputSeparatorKeyCodes","formControl","matAutocomplete","matChipInputTokenEnd"],["tagInput",""],[3,"optionSelected"],["auto","matAutocomplete"],[3,"value","ngClass",4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutGap","10px"],["appearance","outline"],[1,"selection-text",3,"value","valueChange"],["class","option-container",3,"value","onSelectionChange",4,"ngFor","ngForOf"],["mat-flat-button","",1,"sort-direction-button",3,"click"],["color","primary",1,"tag-chip",3,"removable","ngClass","click","removed"],["matChipRemove",""],[3,"value","ngClass"],[1,"option-container",3,"value","onSelectionChange"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0)(1,"mat-form-field",1)(2,"mat-chip-grid",2,3),e.YNc(4,zt,4,3,"mat-chip",4),e.TgZ(5,"input",5,6),e.NdJ("matChipInputTokenEnd",function(a){return i.chipInputEvent(a)}),e.qZA()(),e.TgZ(7,"mat-autocomplete",7,8),e.NdJ("optionSelected",function(a){return i.selected(a)}),e.YNc(9,Kt,2,3,"mat-option",9),e.ALo(10,"async"),e.qZA()(),e.TgZ(11,"div",10)(12,"mat-form-field",11)(13,"mat-label"),e._uU(14,"Sort Filter"),e.qZA(),e.TgZ(15,"mat-select",12),e.NdJ("valueChange",function(a){return i.selectedSort=a}),e.YNc(16,$t,2,2,"mat-option",13),e.qZA()(),e.TgZ(17,"button",14),e.NdJ("click",function(a){return i.changeSortDirection(a)}),e.TgZ(18,"mat-icon"),e._uU(19),e.qZA()()()()),2&t){const s=e.MAs(3),a=e.MAs(8);e.xp6(4),e.Q6J("ngForOf",i.searchTags),e.xp6(1),e.Q6J("matChipInputFor",s)("matChipInputSeparatorKeyCodes",i.separatorKeysCodes)("formControl",i.tagCtrl)("matAutocomplete",a),e.xp6(4),e.Q6J("ngForOf",e.lcZ(10,9,i.filteredTags)),e.xp6(6),e.Q6J("value",i.selectedSort),e.xp6(1),e.Q6J("ngForOf",i.sortTypes),e.xp6(3),e.Oqu(i.selectedDir?"south":"north")}},dependencies:[h.mk,h.sg,m.lW,P.KE,P.hX,Wt.gD,N.ey,x.Hw,fe.XC,fe.ZL,k.HS,k.RA,k.oH,k.qH,u.xw,u.SQ,u.Wh,A.oO,_.Fj,_.JJ,_.oH,h.Ov],styles:[".tag-form-field[_ngcontent-%COMP%]{width:100%}.tag-namespace-series[_ngcontent-%COMP%]{background-color:#a0a}.tag-namespace-system[_ngcontent-%COMP%]{background-color:#996515}.tag-namespace-meta[_ngcontent-%COMP%]{background-color:#000}.tag-namespace-creator[_ngcontent-%COMP%]{background-color:#a00}.tag-namespace-studio[_ngcontent-%COMP%]{background-color:maroon}.tag-namespace-character[_ngcontent-%COMP%]{background-color:#0a0}.tag-namespace-person[_ngcontent-%COMP%]{background-color:green}.tag-namespace-default[_ngcontent-%COMP%]{background-color:#006ffa}.option-container[_ngcontent-%COMP%], .selection-text[_ngcontent-%COMP%]{text-align:center!important}.sort-direction-button[_ngcontent-%COMP%]{height:55px;width:55px;background-color:#62757f6e}"]}),n})();function ei(n,o){1&n&&(e.TgZ(0,"p",19),e._uU(1," Processing Filter... "),e.qZA())}function ti(n,o){if(1&n&&(e.TgZ(0,"div",16),e._UZ(1,"mat-progress-bar",17),e.YNc(2,ei,2,0,"p",18),e.qZA()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",t.processing)}}function ii(n,o){if(1&n&&(e.TgZ(0,"div")(1,"h2"),e._uU(2),e.qZA()()),2&n){const t=e.oxw();e.xp6(2),e.Oqu(t.errorMessage)}}function ni(n,o){if(1&n&&(e.TgZ(0,"div",20),e._UZ(1,"app-image-display-chunk",21),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("hydrusFiles",t.hydrusFiles)}}let oi=(()=>{class n{constructor(t,i,s,a,l,d,oe,U){this.apiService=i,this.fileService=s,this.router=a,this.breakpointObserver=l,this.injectorService=U,this.loading=!0,this.processing=!1,this.mobileView=!1,this.startSearch=!0,this.subscriptions=[],this.chunkSize=3,this.sortType=2,this.sortDir=!0,this.hydrusFiles=[],this.recentlyChangedFileIds=[],this.continueFilter=!1,this.initalTags=["system:limit = 5","system:inbox"],this.searchTags=[],this.overlayUtil=new H(d,oe),this.filterStyle="select-list",t.setTitle("File Search | "+le.N.app_name),this.errorMessage="",this.subscriptions.push(this.router.events.subscribe(S=>{if(S instanceof y.m2){if(S.url.includes("?")){this.searchParams=new URLSearchParams(S.url.slice(S.url.indexOf("?"))),this.saveSearchParams();let _e=this.searchParams.get("tags")?.split(",");_e&&(this.searchTags=_e);let ve=this.searchParams.get("sortType");ve&&(this.sortType=+ve),"false"===this.searchParams.get("sortDir")&&(this.sortDir=!1)}}else this.searchTags=this.initalTags})),this.breakpointObserver.observe([te.u3.Handset,te.u3.Tablet]).subscribe({next:S=>{S.matches&&(this.mobileView=!0,this.filterStyle="full-screen")}})}ngOnDestroy(){this.subscriptions.forEach(t=>{t.unsubscribe()})}ngOnInit(){}tagsChanged(t){this.startSearch&&(this.searchTags=t,this.hydrusFiles=[],this.searchFiles())}sortTypeChanged(t){this.sortType=t,this.searchFiles()}sortDirChanged(t){this.sortDir=t,this.searchFiles()}searchFiles(){this.startSearch&&(this.loading=!0,this.hydrusFiles=[],this.subscriptions.push(this.fileService.getFileWithMetadataFromSearch(this.searchTags,this.sortType.toString(),this.sortDir.toString()).subscribe({next:t=>{this.hydrusFiles=t,this.loading=!1,this.continueFilter&&setTimeout(()=>this.injectorService.announceFullscreenOverlay({files:this.hydrusFiles,currentIndex:0}),300)},error:t=>{this.loading=!1,this.errorMessage=t.message}}))),this.setSearchParams(),this.saveSearchParams()}deleteFile(t){this.apiService.deleteFileById(t).subscribe({next:i=>{}})}startFilter(){this.mobileView?this.overlayUtil.createMobileOverlay():"full-screen"===this.filterStyle?this.overlayUtil.createFullscreenOverlay():"select-list"===this.filterStyle&&this.router.navigate(["/archive-delete-filter-selection"],{state:{files:this.hydrusFiles,tags:this.searchTags,sortDir:this.sortDir,sortType:this.sortType}}),"full-screen"===this.filterStyle&&(setTimeout(()=>this.injectorService.announceFullscreenOverlay({files:this.hydrusFiles,currentIndex:0}),300),this.subscriptions.push(this.injectorService.sendFilesSourceFound$.subscribe(t=>{t.continueFilter?this.continueFilter=!0:(this.overlayUtil.closeOverlay(),this.continueFilter=!1),t.makeChanges?this.updateFileStatuses(t.files):console.log("no changes")})))}setSearchParams(){let t=`?tags=${this.searchTags.flat()}&sortType=${this.sortType}&sortDir=${this.sortDir}`;this.searchParams=new URLSearchParams(t)}saveSearchParams(){var t=window.location.pathname+"?"+this.searchParams.toString();history.pushState(null,"",t)}updateFileStatuses(t){this.loading=!0,this.processing=!0;let i=t.archive.map(a=>a.file_id),s=t.delete.map(a=>a.file_id);this.recentlyChangedFileIds=i.concat(s),i.length>0&&s.length>0?this.subscriptions.push((0,ae.D)([this.apiService.archiveMultipleFilesById(i),this.apiService.deleteMultipleFilesById(s)]).subscribe({next:a=>{this.processing=!1,this.searchFiles()},error:a=>{console.log(a)}})):s.length>0?this.apiService.deleteMultipleFilesById(s).subscribe({next:a=>{this.processing=!1,this.searchFiles()},error:a=>{console.log(a)}}):i.length>0&&this.apiService.archiveMultipleFilesById(i).subscribe({next:a=>{this.processing=!1,this.searchFiles()},error:a=>{console.log(a)}})}viewRecentlyChanged(){console.log(this.recentlyChangedFileIds)}noRecentlyChangedFiles(){return!(this.recentlyChangedFileIds.length>0)}changeSearchStatus(){this.startSearch=!this.startSearch,this.startSearch&&this.searchFiles()}downloadFile(t){this.fileService.downloadFile(t).subscribe({next:i=>{const s=document.createElement("a");document.body.appendChild(s);let a=window.URL.createObjectURL(i);s.href=a,s.download=`${t.hash}.${t.mime.substring(t.mime.indexOf("\\")+1)}`,s.click(),window.URL.revokeObjectURL(a),s.remove(),window.open(a)}})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(he.Dx),e.Y36(Y.s),e.Y36(M),e.Y36(y.F0),e.Y36(te.Yg),e.Y36(e.s_b),e.Y36(I.aV),e.Y36(O))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-file-search"]],decls:21,vars:8,consts:[[1,"main-container"],["fxLayout","column"],["fxLayout","row"],[1,"tag-input",3,"initalTags","initalSortDir","initalSortType","tags","sortType","sortDir"],["mat-flat-button","","color","accent",1,"search-play-button",3,"click"],["id","dark-mode-divider","fxHide","","fxShow.lt-md",""],["fxLayout.gt-sm","row","fxLayoutGap","10px","fxLayout.lt-md","column","fxLayoutAlign.lt-md","center center"],["mat-flat-button","","color","primary",1,"filter-button",3,"click"],["fxShow","","fxHide.lt-md",""],["aria-label","Filter Selection Type",3,"ngModel","ngModelChange"],["value","select-list"],["value","full-screen"],[1,"content-container"],["fxLayout","column","class","loading-container",4,"ngIf"],[4,"ngIf"],["class","image-chunk-container",4,"ngIf"],["fxLayout","column",1,"loading-container"],["mode","indeterminate"],["matLine","","class","processing-text",4,"ngIf"],["matLine","",1,"processing-text"],[1,"image-chunk-container"],[3,"hydrusFiles"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"app-search-tag-input",3),e.NdJ("tags",function(a){return i.tagsChanged(a)})("sortType",function(a){return i.sortTypeChanged(a)})("sortDir",function(a){return i.sortDirChanged(a)}),e.qZA(),e.TgZ(4,"button",4),e.NdJ("click",function(){return i.changeSearchStatus()}),e.TgZ(5,"mat-icon"),e._uU(6),e.qZA()()(),e._UZ(7,"mat-divider",5),e.TgZ(8,"div",6)(9,"button",7),e.NdJ("click",function(){return i.startFilter()}),e._uU(10," Send to Archive/Delete Filter "),e.qZA(),e.TgZ(11,"section",8)(12,"mat-button-toggle-group",9),e.NdJ("ngModelChange",function(a){return i.filterStyle=a}),e.TgZ(13,"mat-button-toggle",10),e._uU(14,"Select List"),e.qZA(),e.TgZ(15,"mat-button-toggle",11),e._uU(16,"Full Screen"),e.qZA()()()()(),e.TgZ(17,"div",12),e.YNc(18,ti,3,1,"div",13),e.YNc(19,ii,3,1,"div",14),e.YNc(20,ni,2,1,"div",15),e.qZA()()),2&t&&(e.xp6(3),e.Q6J("initalTags",i.initalTags)("initalSortDir",i.sortDir)("initalSortType",i.sortType),e.xp6(3),e.Oqu(i.startSearch?"play_arrow":"pause"),e.xp6(6),e.Q6J("ngModel",i.filterStyle),e.xp6(6),e.Q6J("ngIf",i.loading&&!i.errorMessage),e.xp6(1),e.Q6J("ngIf",!i.loading&&i.errorMessage),e.xp6(1),e.Q6J("ngIf",i.hydrusFiles&&!i.loading&&!i.errorMessage))},dependencies:[h.O5,m.lW,F.d,x.Hw,N.X2,$.A9,$.Yi,ge.pW,u.xw,u.SQ,u.Wh,A.b8,_.JJ,_.On,qt,Xt],styles:[".archive-delete-disabled[_ngcontent-%COMP%]{color:red}.archive-delete-enabled[_ngcontent-%COMP%]{color:green}.tag-input[_ngcontent-%COMP%]{width:95%;display:block}.files-container[_ngcontent-%COMP%]{margin:10px;width:265px}.filter-button[_ngcontent-%COMP%]{width:250px;color:#f5f5f5}.image-list-image[_ngcontent-%COMP%]{width:100%;height:100%;background-repeat:no-repeat!important;background-position:center!important;background-size:cover!important;animation:fadeIn ease .5s;background-color:#c7c5cb}.grid-item[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{-webkit-tap-highlight-color:transparent}.processing-text[_ngcontent-%COMP%]{text-align:center;margin-top:25px;font-size:25px}.loading-container[_ngcontent-%COMP%]{margin-top:15px}.search-play-button[_ngcontent-%COMP%]{height:55px;margin-left:10px}.search-play-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{height:35px;width:35px;line-height:35px;font-size:35px}.download-button[_ngcontent-%COMP%]{width:100%;background-color:#c5cae959}.mat-button-toggle-checked[_ngcontent-%COMP%]{background-color:#087f23}.image-chunk-container[_ngcontent-%COMP%]{height:calc(100vh - 230px)}"]}),n})();var ie=r(4201),si=r(5509),ne=r(7988),ai=r(1274);function li(n,o){if(1&n&&(e.TgZ(0,"a",16,17),e._uU(2),e.qZA()),2&n){const t=o.$implicit;e.Q6J("routerLink",t.path),e.xp6(2),e.hij(" ",t.label," ")}}function ri(n,o){if(1&n&&(e.TgZ(0,"div",18)(1,"div",19),e.ALo(2,"date"),e.TgZ(3,"mat-icon"),e._uU(4,"lock_clock"),e.qZA()(),e.TgZ(5,"div",20)(6,"mat-icon"),e._uU(7,"mail"),e.qZA(),e._uU(8),e.qZA(),e.TgZ(9,"div",21)(10,"mat-icon"),e._uU(11,"archive"),e.qZA(),e._uU(12),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("matTooltip","Last Updated: "+e.xi3(2,3,t.lastUpdated,"short")),e.xp6(7),e.hij(" ",t.abbreviateNumber(t.dbStats.boned_stats.num_inbox)," "),e.xp6(4),e.hij(" ",t.abbreviateNumber(t.dbStats.boned_stats.num_archive)," ")}}function ci(n,o){if(1&n&&(e.TgZ(0,"div",22),e._UZ(1,"img",23),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("src",t.userAvatar,e.LSH)}}function hi(n,o){if(1&n&&e._UZ(0,"img",24),2&n){const t=e.oxw();e.Q6J("src",t.logo,e.LSH)}}function ui(n,o){if(1&n&&(e.TgZ(0,"div")(1,"a",25),e._uU(2),e.qZA(),e._UZ(3,"mat-divider",14),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("routerLink",t.path),e.xp6(1),e.Oqu(t.label)}}let gi=(()=>{class n{constructor(t,i,s){this.router=t,this.apiService=i,this.cdr=s,this.navLinks=[{path:"file-search",label:"Search"}],this.panelLinks=[{path:"",label:""}],this.loading=!0,this.lastUpdated=new Date,this.loginUtil=si.t,this.logo="",this.images=[],this.imgNum=30}ngAfterViewInit(){this.logo=this.determineLogo(),this.cdr.detectChanges()}ngOnInit(){this.updateStats();for(let t=0;t<this.imgNum;t++)this.images.push("tab-logo ("+t+").png")}logoutUser(){this.loginUtil.clearStorage(),this.router.navigate(["/login"])}updateStats(){this.apiService.howBoned().subscribe({next:t=>{this.dbStats=t}})}abbreviateNumber(t){var s=Math.log10(Math.abs(t))/3|0;if(0==s)return t+"";var a=["","k","M","G","T","P","E"][s];return(t/Math.pow(10,3*s)).toFixed(1)+a}determineLogo(){let i=Math.floor(Math.random()*(this.images.length-1-0+1)+0);return"assets/"+this.images[i]}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(y.F0),e.Y36(Y.s),e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-toolbar"]],decls:25,vars:6,consts:[["color","primary",1,"toolbar-container"],["fxLayout","row","fxLayoutAlign","center center","fxLayoutGap","65px"],["mat-list-item","","routerLinkActive","","class","nav-links",3,"routerLink",4,"ngFor","ngForOf"],[1,"toolbar-spacer"],["fxLayoutAlign","center center","fxLayoutGap","20px","fxLayout","row","class","db-stats-container",4,"ngIf"],["fxLayoutGap","35px","fxLayout","row","fxLayoutAlign","center center"],["mat-icon-button","",1,"panel-settings-button",3,"matMenuTriggerFor"],["fxLayoutAlign","center center",4,"ngIf","ngIfElse"],["adminPanel",""],["fxLayoutAlign","center center",1,"panel-settings-menu"],["otherMenus","matMenu"],[4,"ngFor","ngForOf"],["mat-menu-item","","fxLayoutAlign","space-between center","fxLayout","row",1,"seperate-menu-item"],["mat-icon-button","",1,"update-stats-button",3,"click"],["id","dark-mode-divider"],["mat-icon-button","",1,"logout-button",3,"click"],["mat-list-item","","routerLinkActive","",1,"nav-links",3,"routerLink"],["rla","routerLinkActive"],["fxLayoutAlign","center center","fxLayoutGap","20px","fxLayout","row",1,"db-stats-container"],["fxLayoutAlign","center center","fxLayoutGap","5px","matTooltip","Last Updated",3,"matTooltip"],["fxLayoutAlign","center center","fxLayoutGap","5px","matTooltip","Inbox"],["fxLayoutAlign","center center","fxLayoutGap","5px","matTooltip","Archive"],["fxLayoutAlign","center center"],["id","mat-icon-32",1,"user-avatar",3,"src"],[1,"menu-logo",3,"src"],["mat-menu-item","",3,"routerLink"]],template:function(t,i){if(1&t&&(e.TgZ(0,"mat-toolbar",0)(1,"div",1),e.YNc(2,li,3,2,"a",2),e.qZA(),e._UZ(3,"span",3),e.YNc(4,ri,13,6,"div",4),e.TgZ(5,"div",5)(6,"div")(7,"button",6),e.YNc(8,ci,2,1,"div",7),e.YNc(9,hi,1,1,"ng-template",null,8,e.W1O),e.qZA(),e.TgZ(11,"mat-menu",9,10),e.YNc(13,ui,4,2,"div",11),e.TgZ(14,"div",12)(15,"button",13),e.NdJ("click",function(){return i.updateStats()}),e.TgZ(16,"mat-icon"),e._uU(17,"update"),e.qZA(),e._uU(18," Database Stats "),e.qZA()(),e._UZ(19,"mat-divider",14),e.TgZ(20,"div",12)(21,"button",15),e.NdJ("click",function(){return i.logoutUser()}),e.TgZ(22,"mat-icon"),e._uU(23,"logout"),e.qZA(),e._uU(24," Logout "),e.qZA()()()()()()),2&t){const s=e.MAs(10),a=e.MAs(12);e.xp6(2),e.Q6J("ngForOf",i.navLinks),e.xp6(2),e.Q6J("ngIf",i.dbStats),e.xp6(3),e.Q6J("matMenuTriggerFor",a),e.xp6(1),e.Q6J("ngIf",i.userAvatar)("ngIfElse",s),e.xp6(5),e.Q6J("ngForOf",i.panelLinks)}},dependencies:[h.sg,h.O5,y.rH,y.Od,m.RK,ne.VK,ne.OP,ne.p6,b.Tg,F.d,ai.Ye,x.Hw,E.gM,u.xw,u.SQ,u.Wh,h.uU],styles:[".nav-links[_ngcontent-%COMP%]{font-size:31px;text-decoration:none}.nav-links[_ngcontent-%COMP%], .toolbar-icons[_ngcontent-%COMP%], .span-text[_ngcontent-%COMP%]{color:#f5f5f5}.toolbar-container[_ngcontent-%COMP%]{padding-right:20px;padding-left:20px;border-bottom:whitesmoke 1px solid}.toolbar-spacer[_ngcontent-%COMP%]{flex:1 1 auto}.storage-container[_ngcontent-%COMP%]{margin-right:70px}.storage-icon[_ngcontent-%COMP%]{color:#81d4fa}.loading-icon[_ngcontent-%COMP%], .span-text-loading[_ngcontent-%COMP%]{color:#1b1b1b;text-shadow:1px 1px 1px rgba(245,245,245,.241)!important}.vertical-divider[_ngcontent-%COMP%]{height:35px;margin-left:30px;margin-right:30px;border-width:2px!important;border-color:#fff}.panel-settings-button[_ngcontent-%COMP%]{color:#e3f2fd;text-shadow:1px 1px 1px black}.warning-icon-button[_ngcontent-%COMP%]{text-shadow:1px 1px 1px black}.menu-item[_ngcontent-%COMP%]{margin:0 0 16px;padding:0 16px}.menu-item-text[_ngcontent-%COMP%]{margin-top:-15px}.span-text[_ngcontent-%COMP%]{margin-left:5px}.logout-button[_ngcontent-%COMP%]{float:right}.menu-logo[_ngcontent-%COMP%]{height:50px;width:auto;margin-top:-7px;border-radius:50%}.db-stats-container[_ngcontent-%COMP%]{margin-right:15px}.seperate-menu-item[_ngcontent-%COMP%]{margin-top:-8px}"]}),n})();const pi=[{path:"",canActivateChild:[ie.a],component:(()=>{class n{constructor(t,i){this.injectorService=t,this.cdr=i,this.subscriptions=[]}ngAfterViewInit(){}ngOnInit(){}ngOnDestroy(){this.subscriptions.forEach(t=>{t.unsubscribe()})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(O),e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-home"]],decls:2,vars:0,template:function(t,i){1&t&&e._UZ(0,"app-toolbar")(1,"router-outlet")},dependencies:[y.lC,gi]}),n})(),children:[{path:"",redirectTo:"file-search",pathMatch:"full"},{path:"file-search",canActivate:[ie.a],component:oi},{path:"archive-delete-filter-selection",canActivate:[ie.a],component:Rt}]}];let mi=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[y.Bz.forChild(pi),y.Bz]}),n})(),fi=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[h.ez,mi,Ce.o]}),n})()}}]);